\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro

    \usepackage{iftex}
    \ifPDFTeX
        \usepackage[T1]{fontenc}
        \IfFileExists{alphabeta.sty}{
              \usepackage{alphabeta}
          }{
              \usepackage[mathletters]{ucs}
              \usepackage[utf8x]{inputenc}
          }
    \else
        \usepackage{fontspec}
        \usepackage{unicode-math}
    \fi

    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage{array}     % table support for pandoc >= 2.11.3
    \usepackage{calc}      % table minipage width calculation for pandoc >= 2.11.1
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}

    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}


    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{Shu's\_FMCG\_Project\_Final}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.61,0.40,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.80,0.25,0.22}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.46,0.46,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.41,0.47,0.13}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.36,0.12}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.52,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{0.89,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb.
    \makeatletter
        \newbox\Wrappedcontinuationbox
        \newbox\Wrappedvisiblespacebox
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}}
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}}
        \newcommand*\Wrappedcontinuationindent {3ex }
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox}
        % Take advantage of the already applied Pygments mark-up to insert
        % potential linebreaks for TeX processing.
        %        {, <, #, %, $, ' and ": go to next line.
        %        _, }, ^, &, >, - and ~: stay at end of broken line.
        % Use of \textquotesingle for straight quote.
        \newcommand*\Wrappedbreaksatspecials {%
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}%
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}%
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}%
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}%
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}%
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}%
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}%
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}%
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}%
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}%
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}%
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}%
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}%
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}%
        }
        % Some characters . , ; ? ! / are not pygmentized.
        % This macro makes them "active" and they will insert potential linebreaks
        \newcommand*\Wrappedbreaksatpunct {%
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}%
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}%
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}%
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}%
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}%
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}%
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}%
            \catcode`\.\active
            \catcode`\,\active
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active
            \lccode`\~`\~
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%

        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}

    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \hypertarget{calculate-total-cost-of-goods-needed--section-1}{%
\section{Calculate total cost of goods needed- Section
1}\label{calculate-total-cost-of-goods-needed--section-1}}

    \hypertarget{import-the-data-for-the-suppliers-demand-and-recipes}{%
\subsection{import the data for the suppliers, demand and
recipes}\label{import-the-data-for-the-suppliers-demand-and-recipes}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{suppliers} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{https://www.dropbox.com/s/jjbacrux6bc1b4s/suppliers.csv?dl=1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{demand} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{https://www.dropbox.com/s/0yikq3pugq87vl9/demand\PYZus{}forecasts.csv?dl=1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{recipes} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{https://www.dropbox.com/s/az97voeh6i8x3i2/recipes.csv?dl=1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{suppliers}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
    supp\_id ingredient\_uuid  cost\_per\_unit unit\_name country\_of\_origin  \textbackslash{}
0  megacorp           cocoa         2500.0     tonne             ghana
1  megacorp     milk\_powder         3200.0     tonne            france

   total\_tax\_per\_unit  time\_to\_deliver
0                  14               12
1                  12                3
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{suppliers}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
     supp\_id ingredient\_uuid  cost\_per\_unit unit\_name country\_of\_origin  \textbackslash{}
0   megacorp           cocoa         2500.0     tonne             ghana
1   megacorp     milk\_powder         3200.0     tonne            france
2   megacorp        hazelnut         1918.0     tonne            turkey
3   megacorp           sugar          457.0     tonne            brazil
4   megacorp         vanilla          237.0     tonne             china
5   omni\_inc           cocoa         2400.0     tonne     cote d'ivoire
6   omni\_inc     milk\_powder         3120.0     tonne       switzerland
7   omni\_inc        hazelnut         1925.0     tonne             italy
8   omni\_inc           sugar          465.0     tonne             india
9   omni\_inc         vanilla          201.0     tonne         indonesia
10  acme\_inc           cocoa         2370.0     tonne         indonesia
11  acme\_inc     milk\_powder         3190.0     tonne           denmark
12  acme\_inc        hazelnut         1817.0     tonne               usa
13  acme\_inc           sugar          476.0     tonne             china
14  acme\_inc         vanilla          185.0     tonne        madagascar

    total\_tax\_per\_unit  time\_to\_deliver
0                   14               12
1                   12                3
2                   12                4
3                    5                9
4                    3               10
5                   14               12
6                    0                2
7                   12                3
8                    5               12
9                    3               12
10                  14               12
11                  12                3
12                  12                8
13                   5               10
14                   3               12
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{demand}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
    rec\_id month  demand
0        1   jan   16443
1        1   feb   18943
2        1   mar   19727
3        1   apr   10368
4        1   may   15125
5        1   jun   18413
6        1   jul   17442
7        1   aug   19986
8        1   sep   15302
9        1   oct   13637
10       1   nov   16877
11       1   dec   15290
12       2   jan   14779
13       2   feb   14568
14       2   mar   11552
15       2   apr   10552
16       2   may   13765
17       2   jun   14758
18       2   jul   11285
19       2   aug   10799
20       2   sep   13370
21       2   oct   13686
22       2   nov   11628
23       2   dec   11724
24       3   jan   12356
25       3   feb   14191
26       3   mar   10613
27       3   apr   10261
28       3   may   10111
29       3   jun   16552
30       3   jul   12428
31       3   aug   19101
32       3   sep   10577
33       3   oct   10309
34       3   nov   15003
35       3   dec   13065
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{recipes} 
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
    rec\_id ingredient\_uuid  cost\_to\_process  time\_to\_process  qty
0        1           cocoa             0.20              120   13
1        1     milk\_powder             0.03              110   12
2        1        hazelnut             0.08               45    4
3        1           sugar             0.40               80    5
4        2         vanilla             0.10               34    3
5        2           cocoa             0.20              120   12
6        2     milk\_powder             0.03              110   11
7        2           sugar             0.40               80    4
8        3        hazelnut             0.08               45    3
9        3         vanilla             0.10               34    2
10       3           cocoa             0.20              120   12
11       3     milk\_powder             0.03               11   12
12       3           sugar             0.40               80    4
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{calculate-the-cheapest-supplier-for-each-ingredient}{%
\subsection{calculate the cheapest supplier for each
ingredient}\label{calculate-the-cheapest-supplier-for-each-ingredient}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{7}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rec\PYZus{}dem}\PY{o}{=} \PY{n}{demand}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{recipes}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rec\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{inner}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{rec\PYZus{}dem}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{7}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
     rec\_id month  demand ingredient\_uuid  cost\_to\_process  time\_to\_process  \textbackslash{}
0         1   jan   16443           cocoa             0.20              120
1         1   jan   16443     milk\_powder             0.03              110
2         1   jan   16443        hazelnut             0.08               45
3         1   jan   16443           sugar             0.40               80
4         1   feb   18943           cocoa             0.20              120
..      {\ldots}   {\ldots}     {\ldots}             {\ldots}              {\ldots}              {\ldots}
151       3   dec   13065        hazelnut             0.08               45
152       3   dec   13065         vanilla             0.10               34
153       3   dec   13065           cocoa             0.20              120
154       3   dec   13065     milk\_powder             0.03               11
155       3   dec   13065           sugar             0.40               80

     qty
0     13
1     12
2      4
3      5
4     13
..   {\ldots}
151    3
152    2
153   12
154   12
155    4

[156 rows x 7 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rec\PYZus{}dem}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demand\PYZus{}qty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=} \PY{n}{rec\PYZus{}dem}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{n}{rec\PYZus{}dem}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{qty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{rec\PYZus{}dem}\PY{o}{=}\PY{n}{rec\PYZus{}dem}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
\PY{n}{rec\PYZus{}dem}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
     rec\_id month  demand ingredient\_uuid  cost\_to\_process  time\_to\_process  \textbackslash{}
0         1   jan   16443           cocoa             0.20              120
1         1   jan   16443     milk\_powder             0.03              110
2         1   jan   16443        hazelnut             0.08               45
3         1   jan   16443           sugar             0.40               80
4         1   feb   18943           cocoa             0.20              120
..      {\ldots}   {\ldots}     {\ldots}             {\ldots}              {\ldots}              {\ldots}
151       3   dec   13065        hazelnut             0.08               45
152       3   dec   13065         vanilla             0.10               34
153       3   dec   13065           cocoa             0.20              120
154       3   dec   13065     milk\_powder             0.03               11
155       3   dec   13065           sugar             0.40               80

     qty  demand\_qty
0     13      213759
1     12      197316
2      4       65772
3      5       82215
4     13      246259
..   {\ldots}         {\ldots}
151    3       39195
152    2       26130
153   12      156780
154   12      156780
155    4       52260

[156 rows x 8 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{9}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{raw}\PY{o}{=} \PY{n}{rec\PYZus{}dem}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{suppliers}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ingredient\PYZus{}uuid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{inner}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{raw}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{9}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
     rec\_id month  demand ingredient\_uuid  cost\_to\_process  time\_to\_process  \textbackslash{}
0         1   jan   16443           cocoa              0.2              120
1         1   jan   16443           cocoa              0.2              120
2         1   jan   16443           cocoa              0.2              120
3         1   feb   18943           cocoa              0.2              120
4         1   feb   18943           cocoa              0.2              120
..      {\ldots}   {\ldots}     {\ldots}             {\ldots}              {\ldots}              {\ldots}
463       3   nov   15003         vanilla              0.1               34
464       3   nov   15003         vanilla              0.1               34
465       3   dec   13065         vanilla              0.1               34
466       3   dec   13065         vanilla              0.1               34
467       3   dec   13065         vanilla              0.1               34

     qty  demand\_qty   supp\_id  cost\_per\_unit unit\_name country\_of\_origin  \textbackslash{}
0     13      213759  megacorp         2500.0     tonne             ghana
1     13      213759  omni\_inc         2400.0     tonne     cote d'ivoire
2     13      213759  acme\_inc         2370.0     tonne         indonesia
3     13      246259  megacorp         2500.0     tonne             ghana
4     13      246259  omni\_inc         2400.0     tonne     cote d'ivoire
..   {\ldots}         {\ldots}       {\ldots}            {\ldots}       {\ldots}               {\ldots}
463    2       30006  omni\_inc          201.0     tonne         indonesia
464    2       30006  acme\_inc          185.0     tonne        madagascar
465    2       26130  megacorp          237.0     tonne             china
466    2       26130  omni\_inc          201.0     tonne         indonesia
467    2       26130  acme\_inc          185.0     tonne        madagascar

     total\_tax\_per\_unit  time\_to\_deliver
0                    14               12
1                    14               12
2                    14               12
3                    14               12
4                    14               12
..                  {\ldots}              {\ldots}
463                   3               12
464                   3               12
465                   3               10
466                   3               12
467                   3               12

[468 rows x 14 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{raw}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cost\PYZus{}demand\PYZus{}qty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=} \PY{n}{raw}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cost\PYZus{}per\PYZus{}unit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{n}{raw}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demand\PYZus{}qty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{raw}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
     rec\_id month  demand ingredient\_uuid  cost\_to\_process  time\_to\_process  \textbackslash{}
0         1   jan   16443           cocoa              0.2              120
1         1   jan   16443           cocoa              0.2              120
2         1   jan   16443           cocoa              0.2              120
3         1   feb   18943           cocoa              0.2              120
4         1   feb   18943           cocoa              0.2              120
..      {\ldots}   {\ldots}     {\ldots}             {\ldots}              {\ldots}              {\ldots}
463       3   nov   15003         vanilla              0.1               34
464       3   nov   15003         vanilla              0.1               34
465       3   dec   13065         vanilla              0.1               34
466       3   dec   13065         vanilla              0.1               34
467       3   dec   13065         vanilla              0.1               34

     qty  demand\_qty   supp\_id  cost\_per\_unit unit\_name country\_of\_origin  \textbackslash{}
0     13      213759  megacorp         2500.0     tonne             ghana
1     13      213759  omni\_inc         2400.0     tonne     cote d'ivoire
2     13      213759  acme\_inc         2370.0     tonne         indonesia
3     13      246259  megacorp         2500.0     tonne             ghana
4     13      246259  omni\_inc         2400.0     tonne     cote d'ivoire
..   {\ldots}         {\ldots}       {\ldots}            {\ldots}       {\ldots}               {\ldots}
463    2       30006  omni\_inc          201.0     tonne         indonesia
464    2       30006  acme\_inc          185.0     tonne        madagascar
465    2       26130  megacorp          237.0     tonne             china
466    2       26130  omni\_inc          201.0     tonne         indonesia
467    2       26130  acme\_inc          185.0     tonne        madagascar

     total\_tax\_per\_unit  time\_to\_deliver  cost\_demand\_qty
0                    14               12      534397500.0
1                    14               12      513021600.0
2                    14               12      506608830.0
3                    14               12      615647500.0
4                    14               12      591021600.0
..                  {\ldots}              {\ldots}              {\ldots}
463                   3               12        6031206.0
464                   3               12        5551110.0
465                   3               10        6192810.0
466                   3               12        5252130.0
467                   3               12        4834050.0

[468 rows x 15 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{cheapest\PYZus{}supplier\PYZus{}igd}\PY{o}{=} \PY{n}{raw}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{raw}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ingredient\PYZus{}uuid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cost\PYZus{}demand\PYZus{}qty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{idxmin}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\PY{n}{cheapest\PYZus{}supplier\PYZus{}igd}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
     rec\_id month  demand ingredient\_uuid  cost\_to\_process  time\_to\_process  \textbackslash{}
86        3   may   10111           cocoa             0.20              120
266       3   may   10111        hazelnut             0.08               45
154       2   apr   10552     milk\_powder             0.03              110
372       3   may   10111           sugar             0.40               80
446       3   may   10111         vanilla             0.10               34

     qty  demand\_qty   supp\_id  cost\_per\_unit unit\_name country\_of\_origin  \textbackslash{}
86    12      121332  acme\_inc         2370.0     tonne         indonesia
266    3       30333  acme\_inc         1817.0     tonne               usa
154   11      116072  omni\_inc         3120.0     tonne       switzerland
372    4       40444  megacorp          457.0     tonne            brazil
446    2       20222  acme\_inc          185.0     tonne        madagascar

     total\_tax\_per\_unit  time\_to\_deliver  cost\_demand\_qty
86                   14               12      287556840.0
266                  12                8       55115061.0
154                   0                2      362144640.0
372                   5                9       18482908.0
446                   3               12        3741070.0
\end{Verbatim}
\end{tcolorbox}
        
    \#merge the cheapest suppliers on the receipes table

    \#merge on the total demand of each ingredient

    \hypertarget{calculate-the-total-cost-of-each-supplier-on-demand-plan}{%
\subsection{calculate the total cost of each supplier on demand
plan}\label{calculate-the-total-cost-of-each-supplier-on-demand-plan}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{12}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{raw}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cost\PYZus{}of\PYZus{}dem}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{raw}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cost\PYZus{}per\PYZus{}unit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{*} \PY{n}{raw}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demand\PYZus{}qty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{raw}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{12}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
     rec\_id month  demand ingredient\_uuid  cost\_to\_process  time\_to\_process  \textbackslash{}
0         1   jan   16443           cocoa              0.2              120
1         1   jan   16443           cocoa              0.2              120
2         1   jan   16443           cocoa              0.2              120
3         1   feb   18943           cocoa              0.2              120
4         1   feb   18943           cocoa              0.2              120
..      {\ldots}   {\ldots}     {\ldots}             {\ldots}              {\ldots}              {\ldots}
463       3   nov   15003         vanilla              0.1               34
464       3   nov   15003         vanilla              0.1               34
465       3   dec   13065         vanilla              0.1               34
466       3   dec   13065         vanilla              0.1               34
467       3   dec   13065         vanilla              0.1               34

     qty  demand\_qty   supp\_id  cost\_per\_unit unit\_name country\_of\_origin  \textbackslash{}
0     13      213759  megacorp         2500.0     tonne             ghana
1     13      213759  omni\_inc         2400.0     tonne     cote d'ivoire
2     13      213759  acme\_inc         2370.0     tonne         indonesia
3     13      246259  megacorp         2500.0     tonne             ghana
4     13      246259  omni\_inc         2400.0     tonne     cote d'ivoire
..   {\ldots}         {\ldots}       {\ldots}            {\ldots}       {\ldots}               {\ldots}
463    2       30006  omni\_inc          201.0     tonne         indonesia
464    2       30006  acme\_inc          185.0     tonne        madagascar
465    2       26130  megacorp          237.0     tonne             china
466    2       26130  omni\_inc          201.0     tonne         indonesia
467    2       26130  acme\_inc          185.0     tonne        madagascar

     total\_tax\_per\_unit  time\_to\_deliver  cost\_demand\_qty  cost\_of\_dem
0                    14               12      534397500.0  534397500.0
1                    14               12      513021600.0  513021600.0
2                    14               12      506608830.0  506608830.0
3                    14               12      615647500.0  615647500.0
4                    14               12      591021600.0  591021600.0
..                  {\ldots}              {\ldots}              {\ldots}          {\ldots}
463                   3               12        6031206.0    6031206.0
464                   3               12        5551110.0    5551110.0
465                   3               10        6192810.0    6192810.0
466                   3               12        5252130.0    5252130.0
467                   3               12        4834050.0    4834050.0

[468 rows x 16 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{13}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{cost\PYZus{}of\PYZus{}dem}\PY{o}{=} \PY{n}{raw}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{supp\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rec\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cost\PYZus{}of\PYZus{}dem}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
\PY{n}{cost\PYZus{}of\PYZus{}dem}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1793581569.py:1:
FutureWarning: Indexing with multiple keys (implicitly converted to a tuple of
keys) will be deprecated, use a list instead.
  cost\_of\_dem= raw.groupby('supp\_id')['rec\_id','cost\_of\_dem'].sum()
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{13}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
          rec\_id   cost\_of\_dem
supp\_id
acme\_inc     324  3.712275e+10
megacorp     324  3.811901e+10
omni\_inc     324  3.702046e+10
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{calculate-the-total-tax-if-satisfy-the-demand-plan}{%
\subsection{calculate the total tax if satisfy the demand
plan}\label{calculate-the-total-tax-if-satisfy-the-demand-plan}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{14}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{raw}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tax\PYZus{}demand\PYZus{}qty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{raw}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}tax\PYZus{}per\PYZus{}unit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{n}{raw}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demand\PYZus{}qty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{15}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{total\PYZus{}tax}\PY{o}{=}\PY{n}{raw}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{supp\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tax\PYZus{}demand\PYZus{}qty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{to\PYZus{}frame}\PY{p}{(}\PY{p}{)}
\PY{n}{total\PYZus{}tax}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{15}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
          tax\_demand\_qty
supp\_id
acme\_inc       186793019
megacorp       186793019
omni\_inc       115962227
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{calculate-the-cheapest-suppliers-per-receipt-if-the-demand-is-satisfied}{%
\subsection{calculate the cheapest suppliers per receipt if the demand
is
satisfied}\label{calculate-the-cheapest-suppliers-per-receipt-if-the-demand-is-satisfied}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{16}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{raw}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{16}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
     rec\_id month  demand ingredient\_uuid  cost\_to\_process  time\_to\_process  \textbackslash{}
0         1   jan   16443           cocoa              0.2              120
1         1   jan   16443           cocoa              0.2              120
2         1   jan   16443           cocoa              0.2              120
3         1   feb   18943           cocoa              0.2              120
4         1   feb   18943           cocoa              0.2              120
..      {\ldots}   {\ldots}     {\ldots}             {\ldots}              {\ldots}              {\ldots}
463       3   nov   15003         vanilla              0.1               34
464       3   nov   15003         vanilla              0.1               34
465       3   dec   13065         vanilla              0.1               34
466       3   dec   13065         vanilla              0.1               34
467       3   dec   13065         vanilla              0.1               34

     qty  demand\_qty   supp\_id  cost\_per\_unit unit\_name country\_of\_origin  \textbackslash{}
0     13      213759  megacorp         2500.0     tonne             ghana
1     13      213759  omni\_inc         2400.0     tonne     cote d'ivoire
2     13      213759  acme\_inc         2370.0     tonne         indonesia
3     13      246259  megacorp         2500.0     tonne             ghana
4     13      246259  omni\_inc         2400.0     tonne     cote d'ivoire
..   {\ldots}         {\ldots}       {\ldots}            {\ldots}       {\ldots}               {\ldots}
463    2       30006  omni\_inc          201.0     tonne         indonesia
464    2       30006  acme\_inc          185.0     tonne        madagascar
465    2       26130  megacorp          237.0     tonne             china
466    2       26130  omni\_inc          201.0     tonne         indonesia
467    2       26130  acme\_inc          185.0     tonne        madagascar

     total\_tax\_per\_unit  time\_to\_deliver  cost\_demand\_qty  cost\_of\_dem  \textbackslash{}
0                    14               12      534397500.0  534397500.0
1                    14               12      513021600.0  513021600.0
2                    14               12      506608830.0  506608830.0
3                    14               12      615647500.0  615647500.0
4                    14               12      591021600.0  591021600.0
..                  {\ldots}              {\ldots}              {\ldots}          {\ldots}
463                   3               12        6031206.0    6031206.0
464                   3               12        5551110.0    5551110.0
465                   3               10        6192810.0    6192810.0
466                   3               12        5252130.0    5252130.0
467                   3               12        4834050.0    4834050.0

     tax\_demand\_qty
0           2992626
1           2992626
2           2992626
3           3447626
4           3447626
..              {\ldots}
463           90018
464           90018
465           78390
466           78390
467           78390

[468 rows x 17 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}chep\PYZus{}supp\PYZus{}rec= raw.groupby(\PYZsq{}rec\PYZus{}id\PYZsq{})[\PYZsq{}cost\PYZus{}tax\PYZus{}sum\PYZsq{}]}
\PY{c+c1}{\PYZsh{}chep\PYZus{}supp\PYZus{}rec}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{18}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} chep\PYZus{}supp\PYZus{}rec= raw.loc[raw.groupby(\PYZsq{}rec\PYZus{}id\PYZsq{})[\PYZsq{}cost\PYZus{}tax\PYZus{}sum\PYZsq{}].idxmin()] }
\PY{c+c1}{\PYZsh{} chep\PYZus{}supp\PYZus{}rec }
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{19}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{cost\PYZus{}of\PYZus{}dem}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{19}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
          rec\_id   cost\_of\_dem
supp\_id
acme\_inc     324  3.712275e+10
megacorp     324  3.811901e+10
omni\_inc     324  3.702046e+10
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{20}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{total\PYZus{}tax}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{20}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
          tax\_demand\_qty
supp\_id
acme\_inc       186793019
megacorp       186793019
omni\_inc       115962227
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{21}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{cost\PYZus{}tax\PYZus{}dem}\PY{o}{=} \PY{n}{cost\PYZus{}of\PYZus{}dem}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{total\PYZus{}tax}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{supp\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{inner}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
\PY{n}{cost\PYZus{}tax\PYZus{}dem}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{21}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
    supp\_id  rec\_id   cost\_of\_dem  tax\_demand\_qty
0  acme\_inc     324  3.712275e+10       186793019
1  megacorp     324  3.811901e+10       186793019
2  omni\_inc     324  3.702046e+10       115962227
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{22}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{cost\PYZus{}tax\PYZus{}dem}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cost\PYZus{}tax\PYZus{}sum}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{cost\PYZus{}tax\PYZus{}dem}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cost\PYZus{}of\PYZus{}dem}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{+}\PY{n}{cost\PYZus{}tax\PYZus{}dem}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tax\PYZus{}demand\PYZus{}qty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{cost\PYZus{}tax\PYZus{}dem}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{22}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
    supp\_id  rec\_id   cost\_of\_dem  tax\_demand\_qty  cost\_tax\_sum
0  acme\_inc     324  3.712275e+10       186793019  3.730954e+10
1  megacorp     324  3.811901e+10       186793019  3.830580e+10
2  omni\_inc     324  3.702046e+10       115962227  3.713642e+10
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{23}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{cost\PYZus{}tax\PYZus{}dem}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{cost\PYZus{}tax\PYZus{}dem}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cost\PYZus{}tax\PYZus{}sum}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{idxmin}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{23}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
supp\_id                omni\_inc
rec\_id                      324
cost\_of\_dem       37020457482.0
tax\_demand\_qty        115962227
cost\_tax\_sum      37136419709.0
Name: 2, dtype: object
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{total-cost-inc.-tax-to-meet-all-demand-per-quarter-with-the-fastest-suppliers}{%
\subsection{total cost (inc. tax) to meet all demand per quarter with
the fastest
suppliers}\label{total-cost-inc.-tax-to-meet-all-demand-per-quarter-with-the-fastest-suppliers}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{24}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{calendar}
\PY{n}{d} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{calendar}\PY{o}{.}\PY{n}{month\PYZus{}abbr}\PY{p}{)}\PY{p}{)}
\PY{n}{d}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{24}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\{0: '',
 1: 'Jan',
 2: 'Feb',
 3: 'Mar',
 4: 'Apr',
 5: 'May',
 6: 'Jun',
 7: 'Jul',
 8: 'Aug',
 9: 'Sep',
 10: 'Oct',
 11: 'Nov',
 12: 'Dec'\}
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{25}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} dic comprehension}
\PY{n}{d} \PY{o}{=} \PY{p}{\PYZob{}} \PY{n}{k}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)} \PY{p}{:} \PY{n}{v} \PY{k}{for} \PY{n}{v}\PY{p}{,}\PY{n}{k} \PY{o+ow}{in} \PY{n}{d}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)} \PY{p}{\PYZcb{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{26}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{demand}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month\PYZus{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=} \PY{n}{demand}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{d}\PY{p}{[}\PY{n}{x}\PY{p}{]}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZhy{}01\PYZhy{}2020}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{27}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{demand}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{quarter}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{demand}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month\PYZus{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{dt}\PY{o}{.}\PY{n}{quarter}
\PY{n}{demand}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{27}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   rec\_id month  demand    month\_n  quarter
0       1   jan   16443  1-01-2020        1
1       1   feb   18943  2-01-2020        1
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{28}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}ost\PYZus{}tax\PYZus{}quarter= raw.groupby([\PYZsq{}ingredient\PYZus{}uuid\PYZsq{},\PYZsq{}quarter\PYZsq{},\PYZsq{}supp\PYZus{}id\PYZsq{}]).sum().reset\PYZus{}index()[[\PYZsq{}ingredient\PYZus{}uuid\PYZsq{},\PYZsq{}quarter\PYZsq{},\PYZsq{}supp\PYZus{}id\PYZsq{},\PYZsq{}cost\PYZus{}tax\PYZus{}sum\PYZsq{}]] }
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{29}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{recipes}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{29}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   rec\_id ingredient\_uuid  cost\_to\_process  time\_to\_process  qty
0       1           cocoa             0.20              120   13
1       1     milk\_powder             0.03              110   12
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{30}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fastest\PYZus{}supplier} \PY{o}{=} \PY{n}{suppliers}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{suppliers}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ingredient\PYZus{}uuid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time\PYZus{}to\PYZus{}deliver}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{idxmin}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\PY{n}{fastest\PYZus{}supplier} 
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{30}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
    supp\_id ingredient\_uuid  cost\_per\_unit unit\_name country\_of\_origin  \textbackslash{}
0  megacorp           cocoa         2500.0     tonne             ghana
7  omni\_inc        hazelnut         1925.0     tonne             italy
6  omni\_inc     milk\_powder         3120.0     tonne       switzerland
3  megacorp           sugar          457.0     tonne            brazil
4  megacorp         vanilla          237.0     tonne             china

   total\_tax\_per\_unit  time\_to\_deliver
0                  14               12
7                  12                3
6                   0                2
3                   5                9
4                   3               10
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{31}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rec\PYZus{}dem}\PY{o}{=} \PY{n}{demand}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{recipes}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rec\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{inner}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{rec\PYZus{}dem}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{31}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
     rec\_id month  demand     month\_n  quarter ingredient\_uuid  \textbackslash{}
0         1   jan   16443   1-01-2020        1           cocoa
1         1   jan   16443   1-01-2020        1     milk\_powder
2         1   jan   16443   1-01-2020        1        hazelnut
3         1   jan   16443   1-01-2020        1           sugar
4         1   feb   18943   2-01-2020        1           cocoa
..      {\ldots}   {\ldots}     {\ldots}         {\ldots}      {\ldots}             {\ldots}
151       3   dec   13065  12-01-2020        4        hazelnut
152       3   dec   13065  12-01-2020        4         vanilla
153       3   dec   13065  12-01-2020        4           cocoa
154       3   dec   13065  12-01-2020        4     milk\_powder
155       3   dec   13065  12-01-2020        4           sugar

     cost\_to\_process  time\_to\_process  qty
0               0.20              120   13
1               0.03              110   12
2               0.08               45    4
3               0.40               80    5
4               0.20              120   13
..               {\ldots}              {\ldots}  {\ldots}
151             0.08               45    3
152             0.10               34    2
153             0.20              120   12
154             0.03               11   12
155             0.40               80    4

[156 rows x 9 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{32}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rec\PYZus{}dem}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dem\PYZus{}qty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{rec\PYZus{}dem}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{n}{rec\PYZus{}dem}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{qty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{rec\PYZus{}dem}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{32}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
     rec\_id month  demand     month\_n  quarter ingredient\_uuid  \textbackslash{}
0         1   jan   16443   1-01-2020        1           cocoa
1         1   jan   16443   1-01-2020        1     milk\_powder
2         1   jan   16443   1-01-2020        1        hazelnut
3         1   jan   16443   1-01-2020        1           sugar
4         1   feb   18943   2-01-2020        1           cocoa
..      {\ldots}   {\ldots}     {\ldots}         {\ldots}      {\ldots}             {\ldots}
151       3   dec   13065  12-01-2020        4        hazelnut
152       3   dec   13065  12-01-2020        4         vanilla
153       3   dec   13065  12-01-2020        4           cocoa
154       3   dec   13065  12-01-2020        4     milk\_powder
155       3   dec   13065  12-01-2020        4           sugar

     cost\_to\_process  time\_to\_process  qty  dem\_qty
0               0.20              120   13   213759
1               0.03              110   12   197316
2               0.08               45    4    65772
3               0.40               80    5    82215
4               0.20              120   13   246259
..               {\ldots}              {\ldots}  {\ldots}      {\ldots}
151             0.08               45    3    39195
152             0.10               34    2    26130
153             0.20              120   12   156780
154             0.03               11   12   156780
155             0.40               80    4    52260

[156 rows x 10 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{33}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rec\PYZus{}dem}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ingredient\PYZus{}uuid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{quarter}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dem\PYZus{}qty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{33}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<AxesSubplot:xlabel='ingredient\_uuid,quarter'>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_41_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{34}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{igd\PYZus{}dem\PYZus{}qrt}\PY{o}{=}\PY{n}{rec\PYZus{}dem}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ingredient\PYZus{}uuid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{quarter}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dem\PYZus{}qty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{to\PYZus{}frame}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
\PY{n}{igd\PYZus{}dem\PYZus{}qrt}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{34}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   ingredient\_uuid  quarter  dem\_qty
0            cocoa        1  1653177
1            cocoa        2  1482766
2            cocoa        3  1616210
3            cocoa        4  1500432
4         hazelnut        1   331932
5         hazelnut        2   286396
6         hazelnut        3   337238
7         hazelnut        4   298347
8      milk\_powder        1  1557165
9      milk\_powder        2  1399785
10     milk\_powder        3  1528026
11     milk\_powder        4  1417590
12           sugar        1   587801
13           sugar        2   523526
14           sugar        3   573890
15           sugar        4   530680
16         vanilla        1   197017
17         vanilla        2   191073
18         vanilla        3   190574
19         vanilla        4   187868
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{35}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{qrt\PYZus{}dem\PYZus{}fastest}\PY{o}{=} \PY{n}{igd\PYZus{}dem\PYZus{}qrt}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{fastest\PYZus{}supplier}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ingredient\PYZus{}uuid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{inner}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{qrt\PYZus{}dem\PYZus{}fastest}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{35}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   ingredient\_uuid  quarter  dem\_qty   supp\_id  cost\_per\_unit unit\_name  \textbackslash{}
0            cocoa        1  1653177  megacorp         2500.0     tonne
1            cocoa        2  1482766  megacorp         2500.0     tonne
2            cocoa        3  1616210  megacorp         2500.0     tonne
3            cocoa        4  1500432  megacorp         2500.0     tonne
4         hazelnut        1   331932  omni\_inc         1925.0     tonne
5         hazelnut        2   286396  omni\_inc         1925.0     tonne
6         hazelnut        3   337238  omni\_inc         1925.0     tonne
7         hazelnut        4   298347  omni\_inc         1925.0     tonne
8      milk\_powder        1  1557165  omni\_inc         3120.0     tonne
9      milk\_powder        2  1399785  omni\_inc         3120.0     tonne
10     milk\_powder        3  1528026  omni\_inc         3120.0     tonne
11     milk\_powder        4  1417590  omni\_inc         3120.0     tonne
12           sugar        1   587801  megacorp          457.0     tonne
13           sugar        2   523526  megacorp          457.0     tonne
14           sugar        3   573890  megacorp          457.0     tonne
15           sugar        4   530680  megacorp          457.0     tonne
16         vanilla        1   197017  megacorp          237.0     tonne
17         vanilla        2   191073  megacorp          237.0     tonne
18         vanilla        3   190574  megacorp          237.0     tonne
19         vanilla        4   187868  megacorp          237.0     tonne

   country\_of\_origin  total\_tax\_per\_unit  time\_to\_deliver
0              ghana                  14               12
1              ghana                  14               12
2              ghana                  14               12
3              ghana                  14               12
4              italy                  12                3
5              italy                  12                3
6              italy                  12                3
7              italy                  12                3
8        switzerland                   0                2
9        switzerland                   0                2
10       switzerland                   0                2
11       switzerland                   0                2
12            brazil                   5                9
13            brazil                   5                9
14            brazil                   5                9
15            brazil                   5                9
16             china                   3               10
17             china                   3               10
18             china                   3               10
19             china                   3               10
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{36}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} ingredient quarterly demand summary  }
\PY{n}{qrt\PYZus{}dem\PYZus{}fastest}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ingredient\PYZus{}uuid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{quarter}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dem\PYZus{}qty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ingredient\PYZus{}uuid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{quarter}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dem\PYZus{}qty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{36}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
ingredient\_uuid
cocoa          AxesSubplot(0.125,0.125;0.775x0.755)
hazelnut       AxesSubplot(0.125,0.125;0.775x0.755)
milk\_powder    AxesSubplot(0.125,0.125;0.775x0.755)
sugar          AxesSubplot(0.125,0.125;0.775x0.755)
vanilla        AxesSubplot(0.125,0.125;0.775x0.755)
dtype: object
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_44_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_44_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_44_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_44_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_44_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{37}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{qrt\PYZus{}dem\PYZus{}fastest}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}cost\PYZus{}tax}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{p}{(}\PY{n}{qrt\PYZus{}dem\PYZus{}fastest}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cost\PYZus{}per\PYZus{}unit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{+}\PY{n}{qrt\PYZus{}dem\PYZus{}fastest}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}tax\PYZus{}per\PYZus{}unit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{*}\PY{n}{qrt\PYZus{}dem\PYZus{}fastest}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dem\PYZus{}qty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{qrt\PYZus{}dem\PYZus{}fastest}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{quarter}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total\PYZus{}cost\PYZus{}tax}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{to\PYZus{}frame}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{37}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
         total\_cost\_tax
quarter
1          9.976242e+09
2          8.937479e+09
3          9.794698e+09
4          9.063127e+09
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{forecast-demand-for-receipe-1---section-2}{%
\section{Forecast demand for receipe 1 - Section
2}\label{forecast-demand-for-receipe-1---section-2}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{38}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{import-the-historic-data}{%
\subsection{import the historic data}\label{import-the-historic-data}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{39}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./demand\PYZus{}trend.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{index\PYZus{}col}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{df}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{39}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
            date  demand
0     2019-01-01     NaN
1     2019-01-02    71.0
2     2019-01-03    70.0
3     2019-01-04    86.0
4     2019-01-05    60.0
{\ldots}          {\ldots}     {\ldots}
1061  2021-11-27  1141.0
1062  2021-11-28     NaN
1063  2021-11-29  1738.5
1064  2021-11-30     NaN
1065  2021-12-01  1156.0

[1066 rows x 2 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{40}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 1066 entries, 0 to 1065
Data columns (total 2 columns):
 \#   Column  Non-Null Count  Dtype
---  ------  --------------  -----
 0   date    1066 non-null   object
 1   demand  811 non-null    float64
dtypes: float64(1), object(1)
memory usage: 25.0+ KB
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{41}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{q}\PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\PY{n}{q}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{41}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<AxesSubplot:xlabel='date'>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_51_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{process-nan-and-missing-data}{%
\subsection{process nan and missing
data}\label{process-nan-and-missing-data}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{42}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{42}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
date        0
demand    255
dtype: int64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{43}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} create column \PYZsq{}y\PYZsq{} using the \PYZsq{}demand\PYZsq{} column }
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{df}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{method}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ffill}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{method}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bfill}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{df}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{43}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
           date  demand       y
0    2019-01-01     NaN    71.0
1    2019-01-02    71.0    71.0
2    2019-01-03    70.0    70.0
3    2019-01-04    86.0    86.0
4    2019-01-05    60.0    60.0
{\ldots}         {\ldots}     {\ldots}     {\ldots}
1061 2021-11-27  1141.0  1141.0
1062 2021-11-28     NaN  1141.0
1063 2021-11-29  1738.5  1738.5
1064 2021-11-30     NaN  1738.5
1065 2021-12-01  1156.0  1156.0

[1066 rows x 3 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{44}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{index}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{basic\PYZus{}trend}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{44}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   basic\_trend       date  demand     y
0            0 2019-01-01     NaN  71.0
1            1 2019-01-02    71.0  71.0
2            2 2019-01-03    70.0  70.0
3            3 2019-01-04    86.0  86.0
4            4 2019-01-05    60.0  60.0
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{45}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} drop na rows in \PYZsq{}y\PYZsq{} column}
\PY{n}{df}\PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{df}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{45}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
      basic\_trend       date  demand       y
0               0 2019-01-01     NaN    71.0
1               1 2019-01-02    71.0    71.0
2               2 2019-01-03    70.0    70.0
3               3 2019-01-04    86.0    86.0
4               4 2019-01-05    60.0    60.0
{\ldots}           {\ldots}        {\ldots}     {\ldots}     {\ldots}
1061         1061 2021-11-27  1141.0  1141.0
1062         1062 2021-11-28     NaN  1141.0
1063         1063 2021-11-29  1738.5  1738.5
1064         1064 2021-11-30     NaN  1738.5
1065         1065 2021-12-01  1156.0  1156.0

[1066 rows x 4 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{46}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} fill na in \PYZsq{}demand\PYZsq{}}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ffill}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{method}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bfill}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{df}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{46}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
      basic\_trend       date  demand       y
0               0 2019-01-01    71.0    71.0
1               1 2019-01-02    71.0    71.0
2               2 2019-01-03    70.0    70.0
3               3 2019-01-04    86.0    86.0
4               4 2019-01-05    60.0    60.0
{\ldots}           {\ldots}        {\ldots}     {\ldots}     {\ldots}
1061         1061 2021-11-27  1141.0  1141.0
1062         1062 2021-11-28  1141.0  1141.0
1063         1063 2021-11-29  1738.5  1738.5
1064         1064 2021-11-30  1738.5  1738.5
1065         1065 2021-12-01  1156.0  1156.0

[1066 rows x 4 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{create-rolling-data-features-and-the-date_based-features}{%
\subsection{create rolling data features and the date\_based
features}\label{create-rolling-data-features-and-the-date_based-features}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{47}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} adding \PYZsq{}holiday\PYZsq{} column and convert it into boolean data }
\PY{k+kn}{from} \PY{n+nn}{pandas}\PY{n+nn}{.}\PY{n+nn}{tseries}\PY{n+nn}{.}\PY{n+nn}{holiday} \PY{k+kn}{import} \PY{n}{USFederalHolidayCalendar} \PY{k}{as} \PY{n}{calendar} 

\PY{n}{cal}\PY{o}{=} \PY{n}{calendar}\PY{p}{(}\PY{p}{)}
\PY{n}{holidays}\PY{o}{=} \PY{n}{cal}\PY{o}{.}\PY{n}{holidays}\PY{p}{(}\PY{n}{start}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)}\PY{p}{)}

\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{holiday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{holidays}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{48}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{holiday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{holiday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
\PY{n}{df}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{48}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
      basic\_trend       date  demand       y  holiday
0               0 2019-01-01    71.0    71.0        1
1               1 2019-01-02    71.0    71.0        0
2               2 2019-01-03    70.0    70.0        0
3               3 2019-01-04    86.0    86.0        0
4               4 2019-01-05    60.0    60.0        0
{\ldots}           {\ldots}        {\ldots}     {\ldots}     {\ldots}      {\ldots}
1061         1061 2021-11-27  1141.0  1141.0        0
1062         1062 2021-11-28  1141.0  1141.0        0
1063         1063 2021-11-29  1738.5  1738.5        0
1064         1064 2021-11-30  1738.5  1738.5        0
1065         1065 2021-12-01  1156.0  1156.0        0

[1066 rows x 5 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{49}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} add \PYZsq{}day\PYZus{}of\PYZus{}week\PYZsq{}, \PYZsq{}month\PYZus{}of\PYZus{}year\PYZsq{},\PYZsq{}rolling\PYZus{}7days\PYZhy{}Avg\PYZsq{}, \PYZsq{}rolling\PYZus{}10days\PYZhy{}Avg\PYZsq{},\PYZsq{}rolling\PYZus{}30days\PYZhy{}Avg\PYZsq{}}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{dt}\PY{o}{.}\PY{n}{day\PYZus{}of\PYZus{}week}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month\PYZus{}of\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{dt}\PY{o}{.}\PY{n}{month}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rol\PYZus{}7}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{l+m+mi}{7}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rol\PYZus{}10}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rol\PYZus{}30}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{l+m+mi}{30}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{df}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{49}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
      basic\_trend       date  demand       y  holiday  day\_of\_week  \textbackslash{}
0               0 2019-01-01    71.0    71.0        1            1
1               1 2019-01-02    71.0    71.0        0            2
2               2 2019-01-03    70.0    70.0        0            3
3               3 2019-01-04    86.0    86.0        0            4
4               4 2019-01-05    60.0    60.0        0            5
{\ldots}           {\ldots}        {\ldots}     {\ldots}     {\ldots}      {\ldots}          {\ldots}
1061         1061 2021-11-27  1141.0  1141.0        0            5
1062         1062 2021-11-28  1141.0  1141.0        0            6
1063         1063 2021-11-29  1738.5  1738.5        0            0
1064         1064 2021-11-30  1738.5  1738.5        0            1
1065         1065 2021-12-01  1156.0  1156.0        0            2

      month\_of\_year        rol\_7   rol\_10       rol\_30
0                 1          NaN      NaN          NaN
1                 1          NaN      NaN          NaN
2                 1          NaN      NaN          NaN
3                 1          NaN      NaN          NaN
4                 1          NaN      NaN          NaN
{\ldots}             {\ldots}          {\ldots}      {\ldots}          {\ldots}
1061             11  1390.571429  1316.90  1290.150000
1062             11  1390.571429  1316.00  1291.816667
1063             11  1392.500000  1374.85  1313.100000
1064             11  1394.428571  1435.20  1334.050000
1065             12  1398.571429  1436.70  1335.583333

[1066 rows x 10 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{remove-created-na}{%
\subsection{remove created na}\label{remove-created-na}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{50}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{=}\PY{n}{df}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
\PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{50}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
    basic\_trend       date  demand      y  holiday  day\_of\_week  \textbackslash{}
29           29 2019-01-30   117.0  117.0        0            2
30           30 2019-01-31   109.0  109.0        0            3
31           31 2019-02-01    86.0   86.0        0            4
32           32 2019-02-02   102.0  102.0        0            5
33           33 2019-02-03    86.0   86.0        0            6

    month\_of\_year       rol\_7  rol\_10      rol\_30
29              1  101.857143   132.9  103.500000
30              1  104.571429   118.6  104.766667
31              2  102.714286   102.0  105.266667
32              2  106.285714   101.0  106.333333
33              2  102.857143   100.6  106.333333
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{define-x-y}{%
\subsection{define X \& y}\label{define-x-y}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{51}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} 1: define X \PYZam{} y. \PYZsq{}date\PYZsq{} is the index for X. }
\PY{c+c1}{\PYZsh{} 2: later step after \PYZsq{}coef\PYZus{}\PYZsq{} report for linear model:drop non\PYZhy{}significant features \PYZsq{}month\PYZus{}of\PYZus{}year\PYZsq{},\PYZsq{}rol\PYZus{}30\PYZsq{}}
\PY{n}{X}\PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{month\PYZus{}of\PYZus{}year}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rol\PYZus{}30}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{basic\PYZus{}trend}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{y}\PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{52}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{y}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{52}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
29       117.0
30       109.0
31        86.0
32       102.0
33        86.0
         {\ldots}
1061    1141.0
1062    1141.0
1063    1738.5
1064    1738.5
1065    1156.0
Name: y, Length: 1037, dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{53}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{53}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
            holiday  day\_of\_week        rol\_7   rol\_10
date
2019-01-30        0            2   101.857143   132.90
2019-01-31        0            3   104.571429   118.60
2019-02-01        0            4   102.714286   102.00
2019-02-02        0            5   106.285714   101.00
2019-02-03        0            6   102.857143   100.60
{\ldots}             {\ldots}          {\ldots}          {\ldots}      {\ldots}
2021-11-27        0            5  1390.571429  1316.90
2021-11-28        0            6  1390.571429  1316.00
2021-11-29        0            0  1392.500000  1374.85
2021-11-30        0            1  1394.428571  1435.20
2021-12-01        0            2  1398.571429  1436.70

[1037 rows x 4 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{use-minmaxscaler-to-scale-the-data}{%
\subsection{use MinMaxScaler to scale the
data}\label{use-minmaxscaler-to-scale-the-data}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{54}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k+kn}{import} \PY{n}{MinMaxScaler}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{compose} \PY{k+kn}{import} \PY{n}{make\PYZus{}column\PYZus{}transformer}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{n}{transformer}\PY{o}{=} \PY{n}{make\PYZus{}column\PYZus{}transformer}\PY{p}{(}
    \PY{p}{(}\PY{n}{MinMaxScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{holiday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,}
    \PY{p}{(}\PY{n}{MinMaxScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,}
    \PY{p}{(}\PY{n}{MinMaxScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rol\PYZus{}7}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,}
    \PY{p}{(}\PY{n}{MinMaxScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rol\PYZus{}10}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}

\PY{n}{X\PYZus{}scaled}\PY{o}{=} \PY{n}{transformer}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X}\PY{p}{)}
\PY{n}{X\PYZus{}scaled}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{54}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([[0.00000000e+00, 3.33333333e-01, 0.00000000e+00, 2.11021461e-02],
       [0.00000000e+00, 5.00000000e-01, 1.80647001e-03, 1.17597099e-02],
       [0.00000000e+00, 6.66666667e-01, 5.70464215e-04, 9.14644105e-04],
       {\ldots},
       [0.00000000e+00, 0.00000000e+00, 8.58976492e-01, 8.32489465e-01],
       [0.00000000e+00, 1.66666667e-01, 8.60260037e-01, 8.71917159e-01],
       [0.00000000e+00, 3.33333333e-01, 8.63017280e-01, 8.72897135e-01]])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{55}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} transfer X\PYZus{}scaled into df}
\PY{n}{X\PYZus{}scaled}\PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(} \PY{n}{data}\PY{o}{=} \PY{n}{X\PYZus{}scaled}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{56}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}scaled}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{56}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
holiday        0.0
day\_of\_week    0.0
rol\_7          0.0
rol\_10         0.0
dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{57}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}scaled}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{57}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
holiday        1.0
day\_of\_week    1.0
rol\_7          1.0
rol\_10         1.0
dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{58}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}scaled}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{58}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<AxesSubplot:>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_73_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{feature-model-selection}{%
\subsection{feature \& model selection}\label{feature-model-selection}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{59}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} test 4 models: linear regression, decision tree regressor, KNN regressor, SGD regressor }
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{60}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} model 1: linear regression  }
\PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k+kn}{import} \PY{n}{linear\PYZus{}model} 
\PY{n}{reg}\PY{o}{=} \PY{n}{linear\PYZus{}model}\PY{o}{.}\PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}
\PY{n}{reg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}scaled}\PY{p}{,}\PY{n}{y}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{60}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
LinearRegression()
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{61}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} a quick test of r2 score}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k+kn}{import} \PY{n}{r2\PYZus{}score}
\PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{reg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}scaled}\PY{p}{)}\PY{p}{,}\PY{n}{y}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{61}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
0.8473156628039933
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{62}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{intercept}\PY{p}{,} \PY{n}{coef}\PY{o}{=} \PY{n}{reg}\PY{o}{.}\PY{n}{intercept\PYZus{}}\PY{p}{,} \PY{n}{reg}\PY{o}{.}\PY{n}{coef\PYZus{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{63}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{data}\PY{o}{=} \PY{p}{[}\PY{n}{reg}\PY{o}{.}\PY{n}{intercept\PYZus{}}\PY{p}{]} \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{reg}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{)}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{intercept}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{)} 
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{63}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
intercept       289.076405
holiday         334.849326
day\_of\_week    -363.719979
rol\_7          1845.262861
rol\_10         -374.774249
dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{64}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} remove non\PYZhy{}significant features in the\PYZsq{}X= df.drop([\PYZsq{}demand\PYZsq{},\PYZsq{}y\PYZsq{}],axis=1).set\PYZus{}index(\PYZsq{}date\PYZsq{})\PYZsq{} above}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{65}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{data}\PY{o}{=} \PY{p}{[}\PY{n}{reg}\PY{o}{.}\PY{n}{intercept\PYZus{}}\PY{p}{]} \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{reg}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{)}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{intercept}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{p}{)} 
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{65}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<AxesSubplot:>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_81_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{66}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} model 2: decision tree regressor}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k+kn}{import} \PY{n}{DecisionTreeRegressor} 
\PY{n}{dtr}\PY{o}{=} \PY{n}{DecisionTreeRegressor}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{67}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} model 3:  KNN regressor. Weights decrease when distance increases }
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{neighbors} \PY{k+kn}{import} \PY{n}{KNeighborsRegressor} 
\PY{n}{knn} \PY{o}{=} \PY{n}{KNeighborsRegressor}\PY{p}{(}\PY{n}{n\PYZus{}neighbors}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{weights}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{distance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{68}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} model 4\PYZhy{} the SGD regressor model }
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k+kn}{import} \PY{n}{SGDRegressor}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k+kn}{import} \PY{n}{make\PYZus{}pipeline}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k+kn}{import} \PY{n}{StandardScaler}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}

\PY{n}{sgdr} \PY{o}{=} \PY{n}{SGDRegressor}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{setup-trainsplittest-for-crossvalidation---timeseries-and-shufflesplit}{%
\subsection{setup train,split,test for CrossValidation - timeseries and
shufflesplit}\label{setup-trainsplittest-for-crossvalidation---timeseries-and-shufflesplit}}

    \hypertarget{k-fold-cross-validation}{%
\subsubsection{K-fold cross validation}\label{k-fold-cross-validation}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{69}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k+kn}{import} \PY{n}{KFold}
\PY{n}{kfcv}\PY{o}{=} \PY{n}{KFold}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=} \PY{l+m+mi}{15}\PY{p}{)}

\PY{n}{lin\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{dtr\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{knn\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{sgdr\PYZus{}scores}\PY{o}{=} \PY{p}{[}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{70}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{report} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{split}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{p}{)}

\PY{n}{n}\PY{o}{=}\PY{l+m+mi}{0} 
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{71}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k+kn}{import} \PY{n}{r2\PYZus{}score}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k+kn}{import} \PY{n}{max\PYZus{}error}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k+kn}{import} \PY{n}{mean\PYZus{}absolute\PYZus{}error}

\PY{k}{for} \PY{n}{train}\PY{p}{,} \PY{n}{test} \PY{o+ow}{in} \PY{n}{kfcv}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{X\PYZus{}scaled}\PY{p}{)}\PY{p}{:}
    \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{X\PYZus{}scaled}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train}\PY{p}{]}\PY{p}{,} \PY{n}{X\PYZus{}scaled}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test}\PY{p}{]}
    \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test}\PY{p}{]}
    
    \PY{n}{reg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
    \PY{n}{dtr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
    \PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
    \PY{n}{sgdr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
    
    \PY{n}{reg\PYZus{}y\PYZus{}pred} \PY{o}{=} \PY{n}{reg}\PY{o}{.}\PY{n}{predict}\PY{p}{(} \PY{n}{X\PYZus{}test} \PY{p}{)}
    \PY{n}{dtr\PYZus{}y\PYZus{}pred} \PY{o}{=} \PY{n}{dtr}\PY{o}{.}\PY{n}{predict}\PY{p}{(} \PY{n}{X\PYZus{}test} \PY{p}{)}
    \PY{n}{knn\PYZus{}y\PYZus{}pred} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{predict}\PY{p}{(} \PY{n}{X\PYZus{}test} \PY{p}{)}
    \PY{n}{sgdr\PYZus{}y\PYZus{}pred} \PY{o}{=} \PY{n}{sgdr}\PY{o}{.}\PY{n}{predict}\PY{p}{(} \PY{n}{X\PYZus{}test} \PY{p}{)}
  
    \PY{n}{report}\PY{o}{=} \PY{n}{report}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{split}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{n}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{reg\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{reg\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,} 
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{reg\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{knn\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{knn\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,} 
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{knn\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{sgdr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{sgdr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,} 
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{sgdr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{,}
                           \PY{n}{ignore\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

    \PY{n}{n}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2982521988.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2982521988.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2982521988.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2982521988.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2982521988.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2982521988.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2982521988.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2982521988.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2982521988.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2982521988.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2982521988.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2982521988.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2982521988.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2982521988.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2982521988.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{72}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{report}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{72}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   split max\_error\_lin    r2\_lin     mae\_lin max\_error\_dtr    r2\_dtr  \textbackslash{}
0    0.0    403.510573  0.338354   97.510761         177.5  -0.43932
1    1.0    360.664295  0.511341   79.270032         117.5  0.428076
2    2.0    235.882911  0.511538   78.427873         172.5  0.222828
3    3.0    212.949813  0.597026   80.482763         348.0 -0.012396
4    4.0     326.64223  0.594188   79.180488        316.75  0.490299
5    5.0    333.564626  0.457364   91.021332        444.75  0.175701
6    6.0    419.888375  0.548063  106.122431        458.25  0.499577
7    7.0    380.165933  0.340025    85.16985         325.5  -0.10612
8    8.0    539.281054  0.227809  110.230289        408.75  0.501774
9    9.0    328.100459  0.267002  104.563493         379.5  0.575363
10  10.0    646.681356  -0.13611  138.535238         510.0  0.460358
11  11.0    441.561697  0.487457  147.401272        968.25  0.401649
12  12.0    725.681601 -0.571816   180.57731         534.0  0.346401
13  13.0    788.603895 -0.603476  172.009206        923.25  0.497672
14  14.0    910.548027 -0.702295  178.799915       1026.75  0.378668

       mae\_dtr max\_error\_knn    r2\_knn     mae\_knn max\_error\_sgdr   r2\_sgdr  \textbackslash{}
0    62.921429    468.346371 -1.984432  108.567511     379.572624  0.345173
1    32.957143    301.038727  0.498066   34.988117     328.846226  0.505094
2    50.721014    245.828482  0.646641   30.422259     212.281278  0.507764
3    63.195652    345.790763  0.617069    49.68798      225.18113  0.561548
4    76.778986    248.139885  0.694616   48.794161     334.743191  0.568593
5    93.474638    420.143129  0.363325   76.042608     389.028112  0.351712
6    96.525362    322.047448  0.694759   76.776522     436.871612  0.435603
7   136.978261    372.755483  0.607022   53.289727     369.960575   0.29043
8   126.916667    411.661031  0.769054   63.328532     557.749541  0.105427
9   102.496377    336.600502  0.700968   69.398256     313.619673  0.180842
10  124.775362    486.539228   0.66394  100.314555     665.510727 -0.345181
11   275.92029    406.431077  0.495037  168.062113     517.879875  0.418691
12  208.775362    776.659038  0.585023  110.767725     795.543794 -0.966635
13  210.757246    942.219342  0.610736   87.418937     871.639937 -0.928621
14  210.952899    739.670425  0.571671  113.612406     927.639033 -0.881045

      mae\_sgdr
0    87.409107
1    73.913615
2    72.333388
3     79.04696
4    77.544569
5    94.305064
6   114.070222
7    88.276122
8   114.285185
9   109.843463
10  143.682542
11  155.270516
12  184.875409
13   175.97472
14  179.411071
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{73}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{report}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{73}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
split               7.000000
max\_error\_lin     470.248456
r2\_lin              0.191098
mae\_lin           115.286817
max\_error\_dtr     474.083333
r2\_dtr              0.294702
mae\_dtr           124.943112
max\_error\_knn     454.924729
r2\_knn              0.435566
mae\_knn            79.431427
max\_error\_sgdr    488.404489
r2\_sgdr             0.076626
mae\_sgdr          116.682797
dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{74}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{report}\PY{o}{.}\PY{n}{var}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{74}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
split                20.000000
max\_error\_lin     43209.406489
r2\_lin                0.213444
mae\_lin            1449.512593
max\_error\_dtr     81385.077381
r2\_dtr                0.080182
mae\_dtr            5070.265714
max\_error\_knn     42081.642227
r2\_knn                0.458256
mae\_knn            1329.773436
max\_error\_sgdr    52480.761911
r2\_sgdr               0.320834
mae\_sgdr           1663.352208
dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{report-summary--kfold-cross-validation}{%
\subsubsection{report summary- KFold cross
validation:}\label{report-summary--kfold-cross-validation}}

KNN is the best model tested, with a mean r2 score of 0.435566. Except
the extrme score for the 0th fold, mean R2 is 0.608423.mae\_knn and
max\_error\_knn are both the lowest among the models

    \hypertarget{timeseriessplit-cross-validation}{%
\subsubsection{TimeSeriesSplit Cross
Validation}\label{timeseriessplit-cross-validation}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{75}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k+kn}{import} \PY{n}{TimeSeriesSplit}

\PY{c+c1}{\PYZsh{}at least 3 generally. time series cross validation}
\PY{n}{tscv} \PY{o}{=} \PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{50}\PY{p}{)}

\PY{n}{lin\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{dtr\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{knn\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{sgdr\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{76}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Using multiple metrics to access models\PYZus{}TimeSeriesSplit cross validation}
\PY{n}{report} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{split}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{p}{)}

\PY{n}{n}\PY{o}{=}\PY{l+m+mi}{0}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{77}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k+kn}{import} \PY{n}{r2\PYZus{}score}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k+kn}{import} \PY{n}{max\PYZus{}error}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k+kn}{import} \PY{n}{mean\PYZus{}absolute\PYZus{}error}

\PY{k}{for} \PY{n}{train}\PY{p}{,} \PY{n}{test} \PY{o+ow}{in} \PY{n}{tscv}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{X}\PY{p}{)}\PY{p}{:}
    \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train}\PY{p}{]}\PY{p}{,} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test}\PY{p}{]}
    \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test}\PY{p}{]}
    
    \PY{n}{reg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
    \PY{n}{dtr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
    \PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
    \PY{n}{sgdr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
    
    \PY{n}{reg\PYZus{}y\PYZus{}pred} \PY{o}{=} \PY{n}{reg}\PY{o}{.}\PY{n}{predict}\PY{p}{(} \PY{n}{X\PYZus{}test} \PY{p}{)}
    \PY{n}{dtr\PYZus{}y\PYZus{}pred} \PY{o}{=} \PY{n}{dtr}\PY{o}{.}\PY{n}{predict}\PY{p}{(} \PY{n}{X\PYZus{}test} \PY{p}{)}
    \PY{n}{knn\PYZus{}y\PYZus{}pred} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{predict}\PY{p}{(} \PY{n}{X\PYZus{}test} \PY{p}{)}
    \PY{n}{sgdr\PYZus{}y\PYZus{}pred} \PY{o}{=} \PY{n}{sgdr}\PY{o}{.}\PY{n}{predict}\PY{p}{(} \PY{n}{X\PYZus{}test} \PY{p}{)}

    \PY{n}{report}\PY{o}{=} \PY{n}{report}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{split}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{n}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{reg\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{reg\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,} 
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{reg\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{knn\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{knn\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,} 
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{knn\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{sgdr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{sgdr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,} 
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{sgdr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{,}
                           \PY{n}{ignore\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

    \PY{n}{n}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}1313451084.py:19:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{78}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{report}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{78}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   split max\_error\_lin    r2\_lin     mae\_lin max\_error\_dtr     r2\_dtr  \textbackslash{}
0    0.0     64.730229 -0.263933   24.258697          42.0   0.506348
1    1.0    116.823704  0.211281   49.331911         250.5 -26.667285
2    2.0    144.063766 -2.009214   61.296291         261.5  -0.084654
3    3.0     91.184472 -0.215158   29.624254          63.5   0.663936
4    4.0    132.758124 -0.015886   48.804669         162.5  -0.494476
5    5.0     46.801262  0.717987   20.964821         141.0    0.54112
6    6.0     74.659606  0.083857   34.410768          72.0   0.814912
7    7.0     91.356248  0.020265   44.633369         172.5  -0.038746
8    8.0    268.551188  -0.99309   58.645601        267.75  -3.831016
9    9.0    133.478552 -0.864353   56.579655        261.75   0.461608
10  10.0    104.618876 -0.411826   40.041844        212.25   0.608552
11  11.0    258.547026  -1.25897   89.981302         459.0   0.005525
12  12.0    322.015334   -0.9683   83.758239        330.75   0.507887
13  13.0    122.498628  0.351276   47.106449        316.75   0.341736
14  14.0    107.824173  0.481045     63.6651        222.75   0.647643
15  15.0    375.824972  -0.71823    75.93575         370.5   0.394605
16  16.0    207.261122  -2.28727   86.178234         339.0   0.660379
17  17.0    411.204917 -0.584253  124.144511        673.75   0.421733
18  18.0    174.060488 -1.675516   70.058209         295.5   0.676353
19  19.0    241.299611  0.298915  106.769064         402.0  -0.770356
20  20.0    278.706257 -0.704431  108.990171        428.25   0.222847
21  21.0    306.064254 -0.319938   96.077821         267.5 -11.373285
22  22.0    471.045482 -1.330944  123.335262         520.5  -2.063143
23  23.0    148.372768  0.152829   71.555663         421.5   0.396192
24  24.0     266.82118 -1.411336   95.255137         196.5     0.4752
25  25.0    191.491585 -1.687374   85.934594         143.0    0.92765
26  26.0    195.008345 -0.334144   94.848738         325.5    0.17821
27  27.0      551.3947 -1.871157  156.457065         297.0   0.440177
28  28.0    212.043255 -1.204799   94.220336         247.5    0.68581
29  29.0    575.450119 -0.798639  162.842571        545.25    0.43183
30  30.0    221.130229 -0.216565   99.169529         537.5   0.302632
31  31.0     212.59471 -0.085179   91.844939        450.75   0.636319
32  32.0    242.567469 -0.740303   89.340268         333.5   0.654547
33  33.0    226.741625 -0.067231  108.125808         126.0   0.899796
34  34.0    680.697148 -2.055497  188.354304        660.75   0.433327
35  35.0    667.727828 -1.338941  174.542315         359.0   0.884416
36  36.0    270.735054 -0.272747  125.547939        558.75   0.547056
37  37.0    458.849587  -0.72716  158.431593         498.5  -0.009181
38  38.0    422.198186 -7.244942  197.834469         60.75   0.990151
39  39.0    285.777284  0.412896  109.622176         597.0   0.298899
40  40.0     739.58701 -1.564947  202.835327        714.75  -0.024131
41  41.0    377.007317 -1.776132   158.12554        686.25   0.690017
42  42.0    710.415251 -0.614758  238.901734         751.5   0.620812
43  43.0     293.95375 -1.230173  127.515633         636.0    0.59866
44  44.0    311.014606 -1.512294  136.841869         353.5  -0.707064
45  45.0    782.684826  -0.92775  275.113863        923.25   0.254968
46  46.0    321.007423 -0.131112  126.394317         397.5   0.503812
47  47.0    909.774499 -2.158048  260.050692       1026.75   0.351651
48  48.0    328.467076   0.16843  138.783322         700.0  -0.551242
49  49.0    322.148002 -0.379537  156.031958        647.25   0.089376

     mae\_dtr max\_error\_knn       r2\_knn     mae\_knn          max\_error\_sgdr  \textbackslash{}
0     20.875     76.070394   -15.792442   30.816923   30542266240080.234375
1    103.375    267.996053 -1105.262661   93.143775   79603230282503.828125
2       56.2    165.292407   -15.294692   93.523747   91750515389839.078125
3     22.775     98.841107   -90.973749   65.658105   70021520409015.039062
4     73.325    224.436612   -25.849743   54.074633   133368215235359.90625
5     62.425    121.376479   -16.451331   44.734072   61203405177823.117188
6       31.1    110.641465    -5.457941   46.373793   33415003813005.671875
7       48.1    144.670498    -3.756309    57.29056       144960080755422.5
8    112.525    348.954549  -170.061934  108.415682   27701311266435.363281
9    54.2125    286.335952    -1.243599   93.163301   156883452315532.28125
10   52.9875    203.168917    -2.127911   81.497676       144834469931242.5
11   88.7875    379.400705   -47.375713   120.00141   183267558758563.71875
12   75.3375    400.209315   -16.733418  102.783989   258719350813878.90625
13   68.7625    178.782149    -2.582985   85.374581   13036071823343.923828
14   77.3125    153.583848     -0.72633     64.9451    147426466622409.1875
15   69.4625    446.728944   -10.310841  124.572483    304324053714805.6875
16      63.6    507.383737    -1.469827  147.559604   164848985518419.46875
17  110.8375    529.763329   -13.156036  174.101491    348758223937872.9375
18     116.6    242.340821    -6.759928  139.670426   66777647136770.179688
19  178.6625    513.953926    -7.867202   131.45441   42798570465083.484375
20   78.8625    429.727172  -115.117364  127.276714   109452680795990.96875
21   177.625    424.721393    -7.156037  171.453393      221417624007786.25
22   136.975    629.357835   -16.644494  175.147939    350223748901612.0625
23    123.35    254.911971    -2.379615  127.489054     423739631219157.125
24      47.9     248.49416    -5.717479  139.971418    330724826828984.1875
25      23.7    217.547084    -3.435548  119.694386    346013197572830.9375
26    113.75    306.965472    -8.601651  112.736286   209038468724071.59375
27  128.8375     704.70393    -17.47218  209.423512    163056848643133.3125
28      57.7    270.601397    -6.678384  134.637294    477316260767218.6875
29    142.85    819.368674   -13.212412  218.372989     235286648490933.375
30  209.0125    314.145548    -3.583864  182.974748      572221636795623.75
31     113.4    248.445305    -2.155151  137.346186     468319216826104.875
32     67.25    333.021588    -3.873612  112.352102    496334913138846.8125
33   53.7375    344.319746    -4.584322  203.791732       338728691141341.5
34  110.7375     837.75203   -12.175058  249.044633      911306368436587.25
35    64.825    791.273333    -9.770208  217.417283      710306867948049.75
36     176.2    403.498806    -0.853252  178.067831   34710604806791.292969
37  158.7375    924.275648    -6.089531  225.850176    1062095769148924.125
38     20.55    680.247079   -99.617539  195.995052       646002154886396.5
39  271.7375    622.022532    -2.588577  233.953012    204156084386050.4375
40   228.025    929.371071   -28.378454  306.194526      1294298657903657.5
41   110.425    293.151522    -3.680242  162.750053     1334083937778289.25
42   200.425   1036.296941    -2.939541  286.688067     746059702907722.875
43   247.375    505.677383    -2.894615  235.073067    142650640609153.0625
44   208.125    437.114202    -6.395877  258.144299     1182918889277248.25
45  213.0875   1028.493072   -10.685686  295.890942      1496539032367382.5
46    185.75    569.629807    -5.684123  316.490541      1292532575233863.5
47  131.1125   1072.919928   -21.668264  316.304312      1222602527060517.5
48   304.225     475.44751     0.005086  125.206073  133310333178619.109375
49  360.5625    757.518342    -3.798846  356.122624   87426067452343.984375

        r2\_sgdr                mae\_sgdr
0    -48.786758   25155992032190.585938
1    -13.892527   55527318824713.898438
2   -181.649205    84951006758838.96875
3   -368.055452   64266453879437.476562
4   -164.939968   122641017440865.71875
5   -514.303146   55610646105647.695312
6   -212.350847     30257800614672.4375
7   -228.898128  127157842358828.703125
8    -29.126052   19664528388586.613281
9   -178.330428   139245839400908.40625
10  -183.224928   126777045712638.03125
11   -95.478337    147598951913396.5625
12  -150.761826      229781430222139.25
13    -51.18687   10616477239979.207031
14    -88.32774  120881609338109.453125
15  -401.805488       258516357303097.0
16  -276.615461     147066587687394.375
17    -41.36578       296286370501689.0
18 -4478.381692   65236678124154.460938
19   -20.028975   32045479910227.324219
20   -95.087214    86363394950358.84375
21     -53.7643       163158619183155.5
22  -215.425207     314014922265238.625
23  -383.242555      389122267698560.75
24  -934.322435       313710580465432.0
25 -1523.255851      333183807798722.75
26   -130.74057     185474027776959.875
27   -29.320705  126860767126961.546875
28 -3395.022002    466679898634912.8125
29   -42.100498   171525786944899.71875
30 -1603.107477     551386961884112.125
31  -755.598428     445422473912171.625
32  -933.666878    470975894704439.1875
33  -227.408306     297000245428268.125
34  -216.963536      828545150846950.75
35  -177.056615      629609790243628.25
36    -2.873941    21563145685091.78125
37   -105.10973     823494270432261.375
38  -372.218553     595318636210924.375
39   -57.354303   163686688150116.96875
40  -208.731434      1131396284895855.0
41  -510.915935      1196584329983318.0
42   -49.441569     631354108188411.125
43  -128.306976   130244274977344.40625
44 -3447.168403     1150396097950809.75
45   -63.000183      1247999764952831.5
46  -123.199041     1074732771762994.25
47  -189.403586     1098003677640779.75
48    -5.411876   70774695643047.390625
49   -14.636559   59808445443942.703125
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{visualization---kfold-cross-validation-for-knn}{%
\subsubsection{visualization - KFold cross validation for
KNN}\label{visualization---kfold-cross-validation-for-knn}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{79}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k+kn}{import} \PY{n}{KFold}
\PY{n}{kfcv}\PY{o}{=} \PY{n}{KFold}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=} \PY{l+m+mi}{15}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{80}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} traing test split manual\PYZhy{} 3/4 training, validation on 1/4}
\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{X\PYZus{}scaled}\PY{o}{.}\PY{n}{iloc}\PY{p}{[} \PY{p}{:} \PY{n+nb}{int}\PY{p}{(}\PY{l+m+mf}{0.75}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{X\PYZus{}scaled}\PY{p}{)}\PY{p}{)} \PY{p}{]}\PY{p}{,} \PY{n}{X\PYZus{}scaled}\PY{o}{.}\PY{n}{iloc}\PY{p}{[} \PY{n+nb}{int}\PY{p}{(}\PY{l+m+mf}{0.75}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{X\PYZus{}scaled}\PY{p}{)}\PY{p}{)} \PY{p}{:} \PY{p}{]}
\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[} \PY{p}{:} \PY{n+nb}{int}\PY{p}{(}\PY{l+m+mf}{0.75}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{)} \PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[} \PY{n+nb}{int}\PY{p}{(}\PY{l+m+mf}{0.75}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{)} \PY{p}{:} \PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{81}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} train model \PYZhy{} KNN regressor. Weights decrease when distance increases }
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{neighbors} \PY{k+kn}{import} \PY{n}{KNeighborsRegressor} 
\PY{n}{knn} \PY{o}{=} \PY{n}{KNeighborsRegressor}\PY{p}{(}\PY{n}{n\PYZus{}neighbors}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{weights}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{distance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{82}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)} 
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{82}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
KNeighborsRegressor(weights='distance')
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{83}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{preds}\PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
\PY{n}{preds}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{83}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([ 909.98451626,  851.51375948,  849.17421713,  836.4871442 ,
        854.62896514, 1251.36549524, 1306.46115112,  860.27727896,
        836.85442407,  840.70396416,  859.10471713,  873.42428572,
       1252.19344286, 1288.20173485,  920.8666722 ,  841.53656934,
        836.94100648,  846.79551608,  855.47044284, 1457.21924778,
       1383.99076502, 1243.62221234,  841.79747521,  842.8822341 ,
        849.74965704,  860.44350387, 1543.55867089, 1367.81650081,
       1250.51415857,  841.70476764,  842.91871407,  849.74326803,
        860.44200339, 1543.44037111, 1366.79865161, 1251.24226085,
        841.68005633,  842.92951363,  849.73003509,  860.43517521,
       1461.0835754 , 1379.9710599 , 1241.00315097,  842.01042579,
        842.69843334,  850.00135803,  854.82337797, 1444.38140363,
       1442.55599276, 1038.09497283,  847.40050533,  851.01760198,
        843.9634782 ,  855.80056303, 1202.0694431 , 1706.20285828,
        844.20864134,  852.80224132,  846.79227568,  838.76101442,
        853.03977607, 1213.38907193, 1536.30668587,  844.13038385,
        845.11367943,  849.10079814,  839.43625064,  852.31804073,
       1207.02411759, 1624.16085356,  842.78232417,  843.48461273,
        842.76536613,  841.62094988,  852.04514659, 1729.29858703,
       1447.4915133 , 1033.96867579,  843.13403006,  851.78474919,
        852.33876183,  855.4075326 , 1302.56085319, 1576.57325325,
        843.51875808,  853.67219312,  843.16180157,  841.67763269,
        852.1048744 , 1202.68018284, 1656.28185157,  845.48330577,
        848.67668234, 1121.20998044,  847.64590637,  855.87000347,
       1200.47384322, 1672.50804363,  846.2272139 ,  850.63359877,
        839.61455961,  847.68752816,  856.92309538, 1213.12764255,
       1275.44895121,  863.4280407 ,  846.40956343,  851.30720238,
        834.35129757,  853.31787306, 1750.33075053, 1438.92429523,
       1236.99379435,  841.92895418,  842.77950444,  849.844432  ,
        860.4637143 , 1459.93255969, 1396.41536625, 1034.08933074,
        846.99690542,  851.03948144,  847.66865614,  857.42120623,
       1200.05614947, 1668.07932971,  846.36992501,  850.70558975,
        840.58068273,  847.65576721,  857.35064455, 1199.24091021,
       1654.21109744,  845.83666642,  850.28927825,  840.72930083,
        846.95245814,  856.9072005 , 1199.54195933, 1639.66426336,
        969.90568926,  855.60481022,  841.33232612,  846.36550191,
        856.18213845, 1199.09183111, 1637.20823627,  969.66603578,
        855.61490921,  841.37819244,  846.29926213,  855.99757108,
       1198.99505668, 1632.72587211,  981.49517175,  855.62595918,
        847.73707108,  845.49405281,  855.2441577 , 1296.01632632,
       1625.13091866,  990.59667722,  855.62889796,  847.87756741,
        845.43562394,  855.28268573, 1198.05975755, 1529.27052652,
        845.0731204 ,  853.54055392,  851.13437534,  838.11611702,
        857.55393298, 1715.23289859, 1400.97212831, 1246.40760419,
        841.71883875,  842.9068022 ,  849.7408068 ,  860.41758464,
       1461.54021061, 1376.87060099, 1049.99380681,  846.74821915,
        853.25570913,  846.11618755,  855.84112666, 1423.04240548,
       1533.49935125, 1011.2755799 ,  855.75667268,  849.77052659,
        846.02436957,  855.72243815, 1430.26731447, 1530.313843  ,
       1030.25228472,  847.33315088,  851.40263603,  852.39935806,
        855.54468606, 1432.81393496, 1515.69881066, 1031.01211302,
        847.36457141,  851.09695018,  845.96186139,  855.58093969,
       1679.45012469, 1377.65950437, 1242.98391496,  841.89048602,
        842.78631486,  849.84104668,  860.46618588, 1459.03164446,
       1467.6386984 , 1043.81409841,  846.91031275,  851.75159822,
        852.34499016,  855.38885066, 1440.82984437, 1432.58514533,
       1041.6963999 ,  842.94577306,  852.19942289,  852.29781111,
        855.25082525, 1299.20484468, 1611.15244462,  844.60717851,
        853.94272843,  842.19611352,  844.92469037,  859.23460032,
       1200.36767963, 1537.70651189, 1200.92837831, 1287.80481786,
        842.6333254 ,  849.93209608,  860.536862  , 1460.9277732 ,
       1383.58102411, 1233.13440652,  842.29664139,  842.4009283 ,
        852.16279411,  860.8655208 , 1450.72772331, 1411.46736948,
       1052.11485505, 1288.53731974,  842.54272729,  849.97661824,
        860.58293121, 1459.64036823, 1387.72306744, 1234.94044769])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{84}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{preds}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{84}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
((777, 4), (260, 4), (777,), (260,), 260)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{85}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{comp} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{index}\PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{index}\PY{p}{)}
\PY{n}{comp}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{85}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Empty DataFrame
Columns: []
Index: [2019-01-30 00:00:00, 2019-01-31 00:00:00, 2019-02-01 00:00:00,
2019-02-02 00:00:00, 2019-02-03 00:00:00, 2019-02-04 00:00:00, 2019-02-05
00:00:00, 2019-02-06 00:00:00, 2019-02-07 00:00:00, 2019-02-08 00:00:00,
2019-02-09 00:00:00, 2019-02-10 00:00:00, 2019-02-11 00:00:00, 2019-02-12
00:00:00, 2019-02-13 00:00:00, 2019-02-14 00:00:00, 2019-02-15 00:00:00,
2019-02-16 00:00:00, 2019-02-17 00:00:00, 2019-02-18 00:00:00, 2019-02-19
00:00:00, 2019-02-20 00:00:00, 2019-02-21 00:00:00, 2019-02-22 00:00:00,
2019-02-23 00:00:00, 2019-02-24 00:00:00, 2019-02-25 00:00:00, 2019-02-26
00:00:00, 2019-02-27 00:00:00, 2019-02-28 00:00:00, 2019-03-01 00:00:00,
2019-03-02 00:00:00, 2019-03-03 00:00:00, 2019-03-04 00:00:00, 2019-03-05
00:00:00, 2019-03-06 00:00:00, 2019-03-07 00:00:00, 2019-03-08 00:00:00,
2019-03-09 00:00:00, 2019-03-10 00:00:00, 2019-03-11 00:00:00, 2019-03-12
00:00:00, 2019-03-13 00:00:00, 2019-03-14 00:00:00, 2019-03-15 00:00:00,
2019-03-16 00:00:00, 2019-03-17 00:00:00, 2019-03-18 00:00:00, 2019-03-19
00:00:00, 2019-03-20 00:00:00, 2019-03-21 00:00:00, 2019-03-22 00:00:00,
2019-03-23 00:00:00, 2019-03-24 00:00:00, 2019-03-25 00:00:00, 2019-03-26
00:00:00, 2019-03-27 00:00:00, 2019-03-28 00:00:00, 2019-03-29 00:00:00,
2019-03-30 00:00:00, 2019-03-31 00:00:00, 2019-04-01 00:00:00, 2019-04-02
00:00:00, 2019-04-03 00:00:00, 2019-04-04 00:00:00, 2019-04-05 00:00:00,
2019-04-06 00:00:00, 2019-04-07 00:00:00, 2019-04-08 00:00:00, 2019-04-09
00:00:00, 2019-04-10 00:00:00, 2019-04-11 00:00:00, 2019-04-12 00:00:00,
2019-04-13 00:00:00, 2019-04-14 00:00:00, 2019-04-15 00:00:00, 2019-04-16
00:00:00, 2019-04-17 00:00:00, 2019-04-18 00:00:00, 2019-04-19 00:00:00,
2019-04-20 00:00:00, 2019-04-21 00:00:00, 2019-04-22 00:00:00, 2019-04-23
00:00:00, 2019-04-24 00:00:00, 2019-04-25 00:00:00, 2019-04-26 00:00:00,
2019-04-27 00:00:00, 2019-04-28 00:00:00, 2019-04-29 00:00:00, 2019-04-30
00:00:00, 2019-05-01 00:00:00, 2019-05-02 00:00:00, 2019-05-03 00:00:00,
2019-05-04 00:00:00, 2019-05-05 00:00:00, 2019-05-06 00:00:00, 2019-05-07
00:00:00, 2019-05-08 00:00:00, 2019-05-09 00:00:00, {\ldots}]

[1037 rows x 0 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{86}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{comp}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y\PYZus{}true}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{values}
\PY{n+nb}{len}\PY{p}{(}\PY{n}{comp}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{86}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
1037
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{87}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} fill the prediction blank positions with nan, concat with \PYZsq{}preds\PYZsq{} values  }
\PY{n}{preds} \PY{o}{=} \PY{p}{[} \PY{n}{np}\PY{o}{.}\PY{n}{nan} \PY{p}{]} \PY{o}{*} \PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}  \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{preds}\PY{p}{)}
\PY{n}{preds}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{87}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 909.9845162626208,
 851.5137594761875,
 849.174217127749,
 836.4871441978202,
 854.6289651406848,
 1251.3654952378745,
 1306.461151115005,
 860.2772789562136,
 836.8544240676192,
 840.7039641579631,
 859.1047171326456,
 873.4242857246543,
 1252.1934428550987,
 1288.201734846268,
 920.8666721988336,
 841.5365693434596,
 836.9410064842697,
 846.7955160839826,
 855.470442838953,
 1457.2192477804124,
 1383.990765017965,
 1243.6222123416912,
 841.7974752139475,
 842.8822341048073,
 849.749657040269,
 860.4435038715704,
 1543.558670885238,
 1367.816500814704,
 1250.5141585702086,
 841.7047676389956,
 842.918714065861,
 849.7432680278291,
 860.4420033866309,
 1543.4403711106131,
 1366.7986516096344,
 1251.2422608473682,
 841.6800563315315,
 842.9295136291912,
 849.7300350916298,
 860.4351752066551,
 1461.0835753978474,
 1379.97105990389,
 1241.0031509684932,
 842.0104257920167,
 842.6984333449687,
 850.0013580277412,
 854.8233779736119,
 1444.3814036282395,
 1442.5559927641457,
 1038.0949728277358,
 847.4005053295484,
 851.0176019813327,
 843.9634781975459,
 855.8005630286066,
 1202.0694430961405,
 1706.2028582823846,
 844.2086413429737,
 852.8022413231762,
 846.7922756843077,
 838.7610144193881,
 853.0397760729314,
 1213.3890719267993,
 1536.3066858655623,
 844.1303838468223,
 845.113679434441,
 849.1007981391414,
 839.4362506401504,
 852.3180407338073,
 1207.024117585564,
 1624.1608535568246,
 842.7823241697895,
 843.4846127338405,
 842.7653661250655,
 841.6209498756413,
 852.0451465904316,
 1729.2985870260816,
 1447.4915133045472,
 1033.9686757889901,
 843.1340300624364,
 851.7847491893347,
 852.3387618259077,
 855.4075325978993,
 1302.5608531941043,
 1576.5732532518189,
 843.5187580774299,
 853.6721931184688,
 843.1618015677248,
 841.6776326853881,
 852.10487440042,
 1202.6801828389032,
 1656.2818515678907,
 845.4833057651649,
 848.676682336646,
 1121.2099804407376,
 847.6459063723726,
 855.8700034720574,
 1200.473843218357,
 1672.5080436326004,
 846.2272138993491,
 850.6335987737915,
 839.6145596072039,
 847.6875281551007,
 856.9230953824683,
 1213.12764255488,
 1275.4489512149448,
 863.4280406951731,
 846.4095634309066,
 851.3072023754935,
 834.3512975700148,
 853.3178730557371,
 1750.3307505252292,
 1438.9242952315067,
 1236.993794354985,
 841.9289541790888,
 842.779504436628,
 849.8444320011305,
 860.4637143042238,
 1459.9325596899228,
 1396.415366254906,
 1034.0893307439926,
 846.9969054165414,
 851.0394814380595,
 847.6686561432308,
 857.4212062347949,
 1200.0561494734923,
 1668.0793297127952,
 846.3699250082236,
 850.7055897483624,
 840.5806827266399,
 847.6557672075076,
 857.3506445480641,
 1199.2409102121387,
 1654.2110974362445,
 845.8366664183325,
 850.2892782466654,
 840.7293008284712,
 846.9524581379391,
 856.9072005016244,
 1199.541959325355,
 1639.664263355019,
 969.9056892587599,
 855.6048102195793,
 841.3323261226491,
 846.3655019098546,
 856.1821384512061,
 1199.0918311078963,
 1637.2082362691415,
 969.6660357765538,
 855.6149092050968,
 841.3781924359129,
 846.2992621261293,
 855.9975710807281,
 1198.99505667954,
 1632.7258721138749,
 981.4951717508004,
 855.6259591811532,
 847.7370710811414,
 845.4940528075142,
 855.2441576965226,
 1296.0163263241716,
 1625.1309186629767,
 990.5966772224746,
 855.6288979586218,
 847.8775674095791,
 845.4356239430463,
 855.2826857333139,
 1198.059757546042,
 1529.2705265209804,
 845.073120399813,
 853.5405539206819,
 851.1343753359166,
 838.1161170175849,
 857.5539329750741,
 1715.2328985855088,
 1400.9721283110655,
 1246.4076041911958,
 841.7188387482479,
 842.9068022032677,
 849.7408067968954,
 860.4175846431037,
 1461.540210609295,
 1376.8706009860175,
 1049.9938068081085,
 846.7482191525502,
 853.2557091260164,
 846.1161875511219,
 855.8411266628734,
 1423.0424054765538,
 1533.4993512491826,
 1011.2755798953275,
 855.7566726761756,
 849.7705265934768,
 846.0243695707105,
 855.7224381470959,
 1430.2673144657685,
 1530.3138430013632,
 1030.2522847201105,
 847.3331508782854,
 851.4026360290275,
 852.3993580558382,
 855.5446860617791,
 1432.813934964583,
 1515.698810658406,
 1031.0121130166967,
 847.3645714095824,
 851.0969501833505,
 845.9618613862177,
 855.5809396931478,
 1679.450124685525,
 1377.6595043670252,
 1242.9839149599602,
 841.8904860193803,
 842.7863148625164,
 849.8410466823752,
 860.4661858820376,
 1459.0316444553705,
 1467.6386984015332,
 1043.814098409347,
 846.9103127476025,
 851.7515982196137,
 852.3449901615937,
 855.3888506646682,
 1440.8298443678577,
 {\ldots}]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{88}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} add preds into the df}
\PY{n}{comp}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{preds}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{preds}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{89}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{comp}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{89}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
            y\_true        preds
date
2019-01-30   117.0          NaN
2019-01-31   109.0          NaN
2019-02-01    86.0          NaN
2019-02-02   102.0          NaN
2019-02-03    86.0          NaN
{\ldots}            {\ldots}          {\ldots}
2021-11-27  1141.0   849.976618
2021-11-28  1141.0   860.582931
2021-11-29  1738.5  1459.640368
2021-11-30  1738.5  1387.723067
2021-12-01  1156.0  1234.940448

[1037 rows x 2 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{90}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{comp}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{90}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<AxesSubplot:xlabel='date'>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_111_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{shufflesplit-to-split-the-data}{%
\subsection{ShuffleSplit to split the
data}\label{shufflesplit-to-split-the-data}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{91}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{report} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{split}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}
                                \PY{p}{]} \PY{p}{)}
\PY{n}{n}\PY{o}{=} \PY{l+m+mi}{0}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{92}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k+kn}{import} \PY{n}{ShuffleSplit}

\PY{n}{rs} \PY{o}{=} \PY{n}{ShuffleSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{93}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k+kn}{import} \PY{n}{SGDRegressor}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k+kn}{import} \PY{n}{LinearRegression}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{neighbors} \PY{k+kn}{import} \PY{n}{KNeighborsRegressor} 
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k+kn}{import} \PY{n}{DecisionTreeRegressor}

\PY{n}{lin\PYZus{}reg} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}scaled}\PY{p}{,} \PY{n}{y}\PY{p}{)}
\PY{n}{dtr} \PY{o}{=} \PY{n}{DecisionTreeRegressor}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{KNN} \PY{o}{=} \PY{n}{KNeighborsRegressor}\PY{p}{(}\PY{n}{n\PYZus{}neighbors}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{weights}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{distance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{sgdr} \PY{o}{=} \PY{n}{SGDRegressor}\PY{p}{(}\PY{p}{)}

\PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o+ow}{in} \PY{n}{rs}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{X}\PY{p}{)}\PY{p}{:}
    \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{p}{,} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}
    \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}
        
    \PY{n}{reg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
    \PY{n}{sgdr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
    \PY{n}{KNN}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
    \PY{n}{dtr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
    
    \PY{n}{lin\PYZus{}y\PYZus{}pred} \PY{o}{=} \PY{n}{reg}\PY{o}{.}\PY{n}{predict}\PY{p}{(} \PY{n}{X\PYZus{}test} \PY{p}{)}
    \PY{n}{sgdr\PYZus{}y\PYZus{}pred} \PY{o}{=} \PY{n}{reg}\PY{o}{.}\PY{n}{predict}\PY{p}{(} \PY{n}{X\PYZus{}test} \PY{p}{)}
    \PY{n}{KNN\PYZus{}y\PYZus{}pred} \PY{o}{=} \PY{n}{KNN}\PY{o}{.}\PY{n}{predict}\PY{p}{(} \PY{n}{X\PYZus{}test} \PY{p}{)}
    \PY{n}{dtr\PYZus{}y\PYZus{}pred} \PY{o}{=} \PY{n}{dtr}\PY{o}{.}\PY{n}{predict}\PY{p}{(} \PY{n}{X\PYZus{}test} \PY{p}{)}
    
    \PY{n}{report}\PY{o}{=} \PY{n}{report}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{split}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{n}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{lin\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{lin\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,} 
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{lin\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,} 
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{KNN\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{KNN\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,} 
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{KNN\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{sgdr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{sgdr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{sgdr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{,}
                            \PY{n}{ignore\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    \PY{n}{n}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}  
    
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2715692971.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{94}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{report}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{94}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   split max\_error\_lin    r2\_lin     mae\_lin max\_error\_dtr    r2\_dtr  \textbackslash{}
0    0.0    936.355814  0.760166  132.780114       1267.25  0.835005
1    1.0    793.125793  0.818449  119.605219       1266.25  0.847528
2    2.0    814.185268  0.811638   122.36939        890.25  0.916432
3    3.0    774.731621  0.868888  117.594582       1089.75  0.898815
4    4.0    939.536116  0.797881  124.433602       1026.75  0.843016
..   {\ldots}           {\ldots}       {\ldots}         {\ldots}           {\ldots}       {\ldots}
95  95.0    650.573967  0.866046  106.700052       1183.25  0.898277
96  96.0    722.096689   0.85913  109.634914         510.0  0.918488
97  97.0    737.209642  0.800382  124.729437       1089.75  0.865637
98  98.0    535.862007   0.85441  106.700165       1089.75  0.869416
99  99.0    801.034834  0.830317  116.536264        890.25  0.876388

      mae\_dtr max\_error\_knn    r2\_knn     mae\_knn max\_error\_sgdr   r2\_sgdr  \textbackslash{}
0   83.579808   1266.141287  0.415503  166.312554     936.355814  0.760166
1   77.674038   1253.189831  0.534452   151.02089     793.125793  0.818449
2   69.108654   1163.356909  0.596808  153.625042     814.185268  0.811638
3   75.285577   1245.453765  0.681772  144.895681     774.731621  0.868888
4   90.133654   1315.038005  0.469527  164.111551     939.536116  0.797881
..        {\ldots}           {\ldots}       {\ldots}         {\ldots}            {\ldots}       {\ldots}
95  63.881731   1259.617606  0.575727  150.969315     650.573967  0.866046
96  62.135577   1082.414932  0.646696  145.640292     722.096689   0.85913
97  78.858654   1256.020854  0.462721  160.026661     737.209642  0.800382
98  75.541346   1158.789267  0.664378  144.381994     535.862007   0.85441
99  76.484615   1067.719333   0.65277  147.822759     801.034834  0.830317

      mae\_sgdr
0   132.780114
1   119.605219
2    122.36939
3   117.594582
4   124.433602
..         {\ldots}
95  106.700052
96  109.634914
97  124.729437
98  106.700165
99  116.536264

[100 rows x 13 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{95}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{r2\PYZus{}mean\PYZus{}report} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}knn\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}sgdr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}lin\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}dtr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{p}{)}
\PY{n}{n}\PY{o}{=} \PY{l+m+mi}{0}

\PY{n}{r2\PYZus{}knn\PYZus{}mean}\PY{o}{=} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{KNN\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{r2\PYZus{}sgdr\PYZus{}mean}\PY{o}{=} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{sgdr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{r2\PYZus{}lin\PYZus{}mean}\PY{o}{=} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{lin\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{r2\PYZus{}dtr\PYZus{}mean}\PY{o}{=} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}

\PY{n}{r2\PYZus{}mean\PYZus{}report} \PY{o}{=} \PY{n}{r2\PYZus{}mean\PYZus{}report}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}knn\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}knn\PYZus{}mean}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}sgdr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{r2\PYZus{}sgdr\PYZus{}mean}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}lin\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{r2\PYZus{}lin\PYZus{}mean}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}dtr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}dtr\PYZus{}mean}\PY{p}{\PYZcb{}}\PY{p}{,} 
                                \PY{n}{ignore\PYZus{}index}\PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
\PY{n}{n}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}

\PY{n}{r2\PYZus{}mean\PYZus{}report}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}4161368561.py:9:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  r2\_mean\_report = r2\_mean\_report.append(\{'r2\_knn\_mean': r2\_knn\_mean,
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{95}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
  r2\_knn\_mean r2\_sgdr\_mean r2\_lin\_mean r2\_dtr\_mean
0     0.65277     0.830317    0.830317    0.876388
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{96}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{max\PYZus{}error\PYZus{}mean\PYZus{}report} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}knn\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}sgdr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}lin\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}dtr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{p}{)}
\PY{n}{m}\PY{o}{=} \PY{l+m+mi}{0}

\PY{n}{max\PYZus{}error\PYZus{}knn\PYZus{}mean}\PY{o}{=} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{KNN\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{max\PYZus{}error\PYZus{}sgdr\PYZus{}mean}\PY{o}{=} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{sgdr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{max\PYZus{}error\PYZus{}lin\PYZus{}mean}\PY{o}{=} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{lin\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{max\PYZus{}error\PYZus{}dtr\PYZus{}mean}\PY{o}{=} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}

\PY{n}{max\PYZus{}error\PYZus{}mean\PYZus{}report} \PY{o}{=} \PY{n}{max\PYZus{}error\PYZus{}mean\PYZus{}report}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}knn\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{max\PYZus{}error\PYZus{}knn\PYZus{}mean}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}sgdr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{max\PYZus{}error\PYZus{}sgdr\PYZus{}mean}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}lin\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{max\PYZus{}error\PYZus{}lin\PYZus{}mean}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}dtr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{max\PYZus{}error\PYZus{}dtr\PYZus{}mean}\PY{p}{\PYZcb{}}\PY{p}{,} 
                                \PY{n}{ignore\PYZus{}index}\PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
\PY{n}{m}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}

\PY{n}{max\PYZus{}error\PYZus{}mean\PYZus{}report}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}532847308.py:9: FutureWarning:
The frame.append method is deprecated and will be removed from pandas in a
future version. Use pandas.concat instead.
  max\_error\_mean\_report = max\_error\_mean\_report.append(\{'max\_error\_knn\_mean':
max\_error\_knn\_mean,
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{96}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
  max\_error\_knn\_mean max\_error\_sgdr\_mean max\_error\_lin\_mean max\_error\_dtr\_mean
0        1067.719333          801.034834         801.034834             890.25
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{97}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{mae\PYZus{}mean\PYZus{}report} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}knn\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}sgdr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}lin\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}dtr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{p}{)}
\PY{n}{m}\PY{o}{=} \PY{l+m+mi}{0}

\PY{n}{mae\PYZus{}knn\PYZus{}mean}\PY{o}{=} \PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{KNN\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{mae\PYZus{}sgdr\PYZus{}mean}\PY{o}{=} \PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{sgdr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{mae\PYZus{}lin\PYZus{}mean}\PY{o}{=} \PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{lin\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{mae\PYZus{}dtr\PYZus{}mean}\PY{o}{=} \PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}

\PY{n}{mae\PYZus{}mean\PYZus{}report} \PY{o}{=} \PY{n}{mae\PYZus{}mean\PYZus{}report}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}knn\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{mae\PYZus{}knn\PYZus{}mean}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}sgdr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mae\PYZus{}sgdr\PYZus{}mean}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}lin\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mae\PYZus{}lin\PYZus{}mean}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}dtr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mae\PYZus{}dtr\PYZus{}mean}\PY{p}{\PYZcb{}}\PY{p}{,}
                                \PY{n}{ignore\PYZus{}index}\PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
\PY{n}{m}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}

\PY{n}{mae\PYZus{}mean\PYZus{}report}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2850408021.py:9:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  mae\_mean\_report = mae\_mean\_report.append(\{'mae\_knn\_mean': mae\_knn\_mean,
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{97}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
  mae\_knn\_mean mae\_sgdr\_mean mae\_lin\_mean mae\_dtr\_mean
0   147.822759    116.536264   116.536264    76.484615
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{summary}{%
\subsubsection{Summary:}\label{summary}}

The best model is DTR. r2 score is 0.876388, represents the majority of
the data trend. Mean absolue erros is 76.484615 which is the lowest. Max
error mean (890.25) is the 2nd lowest among the tested models.

    \hypertarget{visualize-the-data---shufflesplit-dtr}{%
\subsection{visualize the data - ShuffleSplit,
dtr}\label{visualize-the-data---shufflesplit-dtr}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{98}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} training test split manual\PYZhy{} 3/4 training, validation on 1/4}
\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{X\PYZus{}scaled}\PY{o}{.}\PY{n}{iloc}\PY{p}{[} \PY{p}{:} \PY{n+nb}{int}\PY{p}{(}\PY{l+m+mf}{0.75}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{X\PYZus{}scaled}\PY{p}{)}\PY{p}{)} \PY{p}{]}\PY{p}{,} \PY{n}{X\PYZus{}scaled}\PY{o}{.}\PY{n}{iloc}\PY{p}{[} \PY{n+nb}{int}\PY{p}{(}\PY{l+m+mf}{0.75}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{X\PYZus{}scaled}\PY{p}{)}\PY{p}{)} \PY{p}{:} \PY{p}{]}
\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[} \PY{p}{:} \PY{n+nb}{int}\PY{p}{(}\PY{l+m+mf}{0.75}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{)} \PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[} \PY{n+nb}{int}\PY{p}{(}\PY{l+m+mf}{0.75}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{)} \PY{p}{:} \PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{99}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{y\PYZus{}train}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{99}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
29      117.0
30      109.0
31       86.0
32      102.0
33       86.0
        {\ldots}
801     858.0
802     863.0
803     893.0
804    1342.5
805    1342.5
Name: y, Length: 777, dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{100}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{y\PYZus{}test}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{100}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
806      896.0
807      896.0
808      863.0
809      880.0
810      880.0
         {\ldots}
1061    1141.0
1062    1141.0
1063    1738.5
1064    1738.5
1065    1156.0
Name: y, Length: 260, dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{101}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}train}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{101}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
     holiday  day\_of\_week     rol\_7    rol\_10
0        0.0     0.333333  0.000000  0.021102
1        0.0     0.500000  0.001806  0.011760
2        0.0     0.666667  0.000570  0.000915
3        0.0     0.833333  0.002947  0.000261
4        0.0     1.000000  0.000666  0.000000
..       {\ldots}          {\ldots}       {\ldots}       {\ldots}
772      0.0     0.666667  0.594899  0.588410
773      0.0     0.833333  0.596040  0.561983
774      0.0     1.000000  0.596515  0.562506
775      0.0     0.000000  0.599510  0.592069
776      0.0     0.166667  0.602505  0.624179

[777 rows x 4 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{102}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}test}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{102}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
      holiday  day\_of\_week     rol\_7    rol\_10
777       0.0     0.333333  0.602791  0.624702
778       0.0     0.500000  0.606403  0.597589
779       0.0     0.666667  0.606879  0.568321
780       0.0     0.833333  0.608495  0.567471
781       0.0     1.000000  0.607259  0.568909
{\ldots}       {\ldots}          {\ldots}       {\ldots}       {\ldots}
1032      0.0     0.833333  0.857693  0.794630
1033      0.0     1.000000  0.857693  0.794042
1034      0.0     0.000000  0.858976  0.832489
1035      0.0     0.166667  0.860260  0.871917
1036      0.0     0.333333  0.863017  0.872897

[260 rows x 4 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{103}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k+kn}{import} \PY{n}{DecisionTreeRegressor}
\PY{n}{dtr} \PY{o}{=} \PY{n}{DecisionTreeRegressor}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{dtr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{103}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
DecisionTreeRegressor(random\_state=0)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{104}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{preds\PYZus{}dtr}\PY{o}{=} \PY{n}{reg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
\PY{n}{preds\PYZus{}dtr}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{104}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([163.04012079, 153.34377908, 143.64421913, 133.94181326,
       124.23586457, 182.45326004, 172.74026288, 163.03354527,
       153.33187563, 143.63266481, 133.92837061, 124.22768475,
       182.45518119, 172.75239894, 163.05222226, 153.39477604,
       143.74362693, 134.08646155, 124.42438851, 182.70764685,
       173.06056004, 163.3993354 , 153.69885367, 143.99260726,
       134.28706285, 124.58357121, 182.80444626, 173.09479577,
       163.3912964 , 153.69429577, 143.99760194, 134.29054253,
       124.58669363, 182.81194163, 173.10713406, 163.40263919,
       153.70513562, 144.00776409, 134.30350482, 124.60206767,
       182.75820624, 172.98390472, 163.2809439 , 153.58416014,
       143.88720162, 134.1393213 , 124.3871681 , 182.61512243,
       172.91255123, 163.21281903, 153.46132047, 143.71092918,
       134.00968286, 124.31396385, 182.53699114, 172.82516337,
       163.06780594, 153.37089212, 143.67258707, 133.97705063,
       124.27174921, 182.49245786, 172.78268844, 163.08113179,
       153.38067732, 143.68188073, 133.97843657, 124.27567249,
       182.50288022, 172.79987574, 163.09656192, 153.39714222,
       143.69561065, 133.9900564 , 124.28395322, 589.99364501,
       172.92684431, 163.2216465 , 153.52523236, 143.82640865,
       134.12408647, 124.42012363, 182.56810338, 172.78589939,
       163.08036154, 153.3848196 , 143.69412706, 133.98889644,
       124.28742348, 182.51329866, 172.80911352, 163.1098905 ,
       153.41232331, 551.138301  , 134.01271092, 124.30598463,
       182.52802232, 172.81968638, 163.11372046, 153.41733739,
       143.71759622, 134.01366621, 124.31007882, 182.48307176,
       172.72562461, 163.0234241 , 153.32436084, 143.62546158,
       133.92134167, 124.21847926, 589.98454852, 172.9739259 ,
       163.3835876 , 153.67621405, 143.97338351, 134.26759108,
       124.56282826, 182.7086047 , 172.92392205, 163.09496676,
       153.40360777, 143.7079681 , 134.01490376, 124.31471066,
       182.54287681, 172.84027055, 163.13488543, 153.43701876,
       143.73798182, 134.03407514, 124.32554082, 182.54570829,
       172.83532172, 163.13305394, 153.43491762, 143.73777294,
       134.03894001, 124.33625107, 182.55922255, 172.85157353,
       163.14650255, 153.44375935, 143.7422149 , 134.03689624,
       124.33693794, 182.5580552 , 172.84885579, 163.14415075,
       153.44635882, 143.74848143, 134.04437103, 124.33855092,
       182.56359798, 172.8584328 , 163.15482818, 153.45892756,
       143.75991829, 134.05458065, 124.35232317, 182.57215446,
       172.86166909, 163.15830264, 153.45756862, 143.75811623,
       134.05280449, 124.34979274, 182.52232648, 172.76442013,
       163.06021139, 153.36224123, 143.66330276, 133.96245292,
       124.25810257, 590.0293506 , 173.0238213 , 163.44616855,
       153.74256651, 144.04258663, 134.33807922, 124.63207791,
       182.77529919, 172.98832725, 163.14665079, 153.45695775,
       143.7658735 , 134.07423951, 124.37058308, 182.59076953,
       172.88038297, 163.17816523, 153.47773585, 143.77925692,
       134.07670945, 124.37460822, 182.60159582, 172.89794394,
       163.1944325 , 153.49615811, 143.79525577, 134.08840781,
       124.38162374, 182.60215322, 172.89214766, 163.18866213,
       153.48936639, 143.78846025, 134.08473478, 124.38394882,
       590.11010069, 173.05934231, 163.35819555, 153.6614354 ,
       143.96468909, 134.26077807, 124.55778788, 182.68773689,
       172.88730276, 163.18040218, 153.48763128, 143.79898916,
       134.09838617, 124.39381406, 182.6185288 , 172.91269901,
       163.21076177, 153.51293145, 143.81212106, 134.10685245,
       124.40253751, 182.56711924, 172.80126087, 163.09831558,
       153.40250176, 143.70583615, 134.00162307, 124.29555963,
       182.57310893, 172.92030358, 163.26673703, 561.038441  ,
       143.91395649, 134.21045197, 124.50825756, 182.7329978 ,
       173.02719351, 163.26904119, 153.51262113, 143.81366924,
       134.1170001 , 124.42097958, 182.64668209, 172.9416122 ,
       163.23561347, 561.01548408, 143.89299898, 134.1892925 ,
       124.48502936, 182.70697808, 172.99834427, 163.29695677])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{105}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{dtr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{105}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
DecisionTreeRegressor(random\_state=0)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{106}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{comp\PYZus{}dtr}\PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n}{X}\PY{o}{.}\PY{n}{index}\PY{p}{)}
\PY{n}{comp\PYZus{}dtr}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{106}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Empty DataFrame
Columns: []
Index: [2019-01-30 00:00:00, 2019-01-31 00:00:00, 2019-02-01 00:00:00,
2019-02-02 00:00:00, 2019-02-03 00:00:00, 2019-02-04 00:00:00, 2019-02-05
00:00:00, 2019-02-06 00:00:00, 2019-02-07 00:00:00, 2019-02-08 00:00:00,
2019-02-09 00:00:00, 2019-02-10 00:00:00, 2019-02-11 00:00:00, 2019-02-12
00:00:00, 2019-02-13 00:00:00, 2019-02-14 00:00:00, 2019-02-15 00:00:00,
2019-02-16 00:00:00, 2019-02-17 00:00:00, 2019-02-18 00:00:00, 2019-02-19
00:00:00, 2019-02-20 00:00:00, 2019-02-21 00:00:00, 2019-02-22 00:00:00,
2019-02-23 00:00:00, 2019-02-24 00:00:00, 2019-02-25 00:00:00, 2019-02-26
00:00:00, 2019-02-27 00:00:00, 2019-02-28 00:00:00, 2019-03-01 00:00:00,
2019-03-02 00:00:00, 2019-03-03 00:00:00, 2019-03-04 00:00:00, 2019-03-05
00:00:00, 2019-03-06 00:00:00, 2019-03-07 00:00:00, 2019-03-08 00:00:00,
2019-03-09 00:00:00, 2019-03-10 00:00:00, 2019-03-11 00:00:00, 2019-03-12
00:00:00, 2019-03-13 00:00:00, 2019-03-14 00:00:00, 2019-03-15 00:00:00,
2019-03-16 00:00:00, 2019-03-17 00:00:00, 2019-03-18 00:00:00, 2019-03-19
00:00:00, 2019-03-20 00:00:00, 2019-03-21 00:00:00, 2019-03-22 00:00:00,
2019-03-23 00:00:00, 2019-03-24 00:00:00, 2019-03-25 00:00:00, 2019-03-26
00:00:00, 2019-03-27 00:00:00, 2019-03-28 00:00:00, 2019-03-29 00:00:00,
2019-03-30 00:00:00, 2019-03-31 00:00:00, 2019-04-01 00:00:00, 2019-04-02
00:00:00, 2019-04-03 00:00:00, 2019-04-04 00:00:00, 2019-04-05 00:00:00,
2019-04-06 00:00:00, 2019-04-07 00:00:00, 2019-04-08 00:00:00, 2019-04-09
00:00:00, 2019-04-10 00:00:00, 2019-04-11 00:00:00, 2019-04-12 00:00:00,
2019-04-13 00:00:00, 2019-04-14 00:00:00, 2019-04-15 00:00:00, 2019-04-16
00:00:00, 2019-04-17 00:00:00, 2019-04-18 00:00:00, 2019-04-19 00:00:00,
2019-04-20 00:00:00, 2019-04-21 00:00:00, 2019-04-22 00:00:00, 2019-04-23
00:00:00, 2019-04-24 00:00:00, 2019-04-25 00:00:00, 2019-04-26 00:00:00,
2019-04-27 00:00:00, 2019-04-28 00:00:00, 2019-04-29 00:00:00, 2019-04-30
00:00:00, 2019-05-01 00:00:00, 2019-05-02 00:00:00, 2019-05-03 00:00:00,
2019-05-04 00:00:00, 2019-05-05 00:00:00, 2019-05-06 00:00:00, 2019-05-07
00:00:00, 2019-05-08 00:00:00, 2019-05-09 00:00:00, {\ldots}]

[1037 rows x 0 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{107}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{comp\PYZus{}dtr}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y\PYZus{}true}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{values}
\PY{n}{comp\PYZus{}dtr}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y\PYZus{}true}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{107}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
date
2019-01-30     117.0
2019-01-31     109.0
2019-02-01      86.0
2019-02-02     102.0
2019-02-03      86.0
               {\ldots}
2021-11-27    1141.0
2021-11-28    1141.0
2021-11-29    1738.5
2021-11-30    1738.5
2021-12-01    1156.0
Name: y\_true, Length: 1037, dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{108}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} fill the prediction blank positions with nan, concat with \PYZsq{}preds\PYZsq{} values  }
\PY{n}{preds\PYZus{}dtr} \PY{o}{=} \PY{p}{[} \PY{n}{np}\PY{o}{.}\PY{n}{nan} \PY{p}{]} \PY{o}{*} \PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}  \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{preds\PYZus{}dtr}\PY{p}{)}
\PY{n}{preds\PYZus{}dtr}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{108}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 163.04012078650408,
 153.34377907753955,
 143.64421912507345,
 133.94181325892393,
 124.23586457274308,
 182.45326003861842,
 172.7402628827237,
 163.03354527350692,
 153.33187563349134,
 143.63266480846636,
 133.92837061342146,
 124.22768475199952,
 182.4551811910516,
 172.75239894263282,
 163.0522222601935,
 153.3947760363698,
 143.74362693299767,
 134.0864615523648,
 124.42438851031709,
 182.70764684797754,
 173.06056003649263,
 163.39933539904422,
 153.69885366990843,
 143.99260726157453,
 134.2870628474087,
 124.5835712135365,
 182.8044462627939,
 173.09479576693215,
 163.39129640121698,
 153.6942957674283,
 143.99760194301805,
 134.29054253090362,
 124.58669363044777,
 182.81194162977212,
 173.10713406296162,
 163.40263919425257,
 153.70513562103397,
 144.00776408982352,
 134.30350482155592,
 124.6020676707655,
 182.75820624150714,
 172.98390471785405,
 163.28094389603726,
 153.5841601440318,
 143.88720162465603,
 134.1393213017466,
 124.3871680952106,
 182.61512243459293,
 172.91255122885613,
 163.21281902640686,
 153.46132046804993,
 143.7109291770047,
 134.00968285794778,
 124.31396385496556,
 182.5369911365837,
 172.82516336971221,
 163.06780594161313,
 153.3708921173553,
 143.67258707137876,
 133.97705063435177,
 124.27174920506467,
 182.49245785969094,
 172.78268844182276,
 163.0811317948716,
 153.3806773205639,
 143.6818807292722,
 133.9784365680247,
 124.27567248720865,
 182.50288022459117,
 172.79987573617737,
 163.09656192099797,
 153.3971422164244,
 143.69561065431992,
 133.99005639822343,
 124.28395322236263,
 589.9936450105482,
 172.92684430860749,
 163.2216465044956,
 153.52523236469546,
 143.82640864521136,
 134.12408646710432,
 124.42012363234925,
 182.56810338137197,
 172.7858993881732,
 163.08036154384558,
 153.38481960142687,
 143.69412706463285,
 133.98889643698323,
 124.28742347807454,
 182.51329865682797,
 172.80911352218405,
 163.10989049871742,
 153.412323314921,
 551.1383010024979,
 134.0127109234388,
 124.30598463429615,
 182.52802232218764,
 172.81968637735892,
 163.11372046481017,
 153.41733738586584,
 143.71759622282687,
 134.01366621160957,
 124.31007881788895,
 182.48307176023917,
 172.72562460819464,
 163.0234240962298,
 153.32436084364085,
 143.6254615752568,
 133.92134167354078,
 124.2184792555953,
 589.9845485172058,
 172.9739259036663,
 163.3835875999359,
 153.67621405389954,
 143.97338351140894,
 134.26759107759003,
 124.5628282589432,
 182.70860469717857,
 172.92392205196933,
 163.09496675526162,
 153.40360776887422,
 143.7079681002754,
 134.01490375824739,
 124.31471066403921,
 182.54287680765682,
 172.84027054850696,
 163.1348854311774,
 153.43701876254596,
 143.73798182355034,
 134.03407514134585,
 124.32554081947019,
 182.54570828617517,
 172.83532172418617,
 163.13305393594777,
 153.4349176214386,
 143.7377729440018,
 134.03894001065652,
 124.3362510714409,
 182.55922254791417,
 172.85157353401897,
 163.1465025506113,
 153.4437593481628,
 143.74221489965333,
 134.03689624399829,
 124.33693793563248,
 182.5580551953886,
 172.84885578957415,
 163.144150752676,
 153.4463588183455,
 143.74848143329055,
 134.04437102609944,
 124.33855092330478,
 182.56359797514926,
 172.8584328011975,
 163.15482818110897,
 153.45892756025438,
 143.7599182902345,
 134.0545806455296,
 124.35232316641518,
 182.5721544588259,
 172.86166908566608,
 163.15830264329998,
 153.45756862129005,
 143.7581162266626,
 134.05280448825147,
 124.34979273518803,
 182.52232648171938,
 172.764420133856,
 163.06021138953548,
 153.36224122921266,
 143.66330276083028,
 133.96245291520344,
 124.25810256760798,
 590.0293505954303,
 173.02382129737833,
 163.4461685508997,
 153.74256650809218,
 144.0425866333955,
 134.33807921883908,
 124.63207790547156,
 182.77529919471363,
 172.98832724720927,
 163.14665078878127,
 153.45695775438645,
 143.76587349827292,
 134.074239507796,
 124.37058307511985,
 182.5907695308747,
 172.8803829688857,
 163.17816523055296,
 153.47773584794004,
 143.77925691593413,
 134.07670944650965,
 124.37460821975712,
 182.60159582038418,
 172.89794394159287,
 163.19443250407176,
 153.49615811165148,
 143.7952557654737,
 134.08840781018887,
 124.38162373929754,
 182.60215321984865,
 172.89214766075565,
 163.18866212952835,
 153.4893663945623,
 143.78846024920495,
 134.08473477757326,
 124.38394881633997,
 590.1101006863817,
 173.0593423071999,
 163.3581955540191,
 153.66143540484217,
 143.96468909015312,
 134.26077806798565,
 124.55778788125312,
 182.68773688565818,
 172.8873027628181,
 163.1804021803466,
 153.48763128382654,
 143.798989157119,
 134.0983861691405,
 124.39381405559145,
 182.61852879906323,
 {\ldots}]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{109}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}train}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{109}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
     holiday  day\_of\_week     rol\_7    rol\_10
0        0.0     0.333333  0.000000  0.021102
1        0.0     0.500000  0.001806  0.011760
2        0.0     0.666667  0.000570  0.000915
3        0.0     0.833333  0.002947  0.000261
4        0.0     1.000000  0.000666  0.000000
..       {\ldots}          {\ldots}       {\ldots}       {\ldots}
772      0.0     0.666667  0.594899  0.588410
773      0.0     0.833333  0.596040  0.561983
774      0.0     1.000000  0.596515  0.562506
775      0.0     0.000000  0.599510  0.592069
776      0.0     0.166667  0.602505  0.624179

[777 rows x 4 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{110}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} add preds into the df}
\PY{n}{comp\PYZus{}dtr}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{preds}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{preds\PYZus{}dtr}
\PY{n}{comp\PYZus{}dtr}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{110}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
            y\_true       preds
date
2019-01-30   117.0         NaN
2019-01-31   109.0         NaN
2019-02-01    86.0         NaN
2019-02-02   102.0         NaN
2019-02-03    86.0         NaN
{\ldots}            {\ldots}         {\ldots}
2021-11-27  1141.0  134.189292
2021-11-28  1141.0  124.485029
2021-11-29  1738.5  182.706978
2021-11-30  1738.5  172.998344
2021-12-01  1156.0  163.296957

[1037 rows x 2 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{111}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{comp\PYZus{}dtr}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{111}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<AxesSubplot:xlabel='date'>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_135_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{timeseriessplit-to-split-the-data-test-models}{%
\subsection{TimeSeriesSplit to split the data test
models}\label{timeseriessplit-to-split-the-data-test-models}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{112}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{report} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{split}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}
                                \PY{p}{]} \PY{p}{)}
\PY{n}{n}\PY{o}{=} \PY{l+m+mi}{0}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{113}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k+kn}{import} \PY{n}{TimeSeriesSplit}
\PY{n}{tscv} \PY{o}{=} \PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{30}\PY{p}{)}    
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{114}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k+kn}{import} \PY{n}{SGDRegressor}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k+kn}{import} \PY{n}{LinearRegression}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{neighbors} \PY{k+kn}{import} \PY{n}{KNeighborsRegressor} 
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k+kn}{import} \PY{n}{DecisionTreeRegressor}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k+kn}{import} \PY{n}{RandomForestClassifier}

\PY{n}{lin\PYZus{}reg} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}scaled}\PY{p}{,} \PY{n}{y}\PY{p}{)}
\PY{n}{dtr} \PY{o}{=} \PY{n}{DecisionTreeRegressor}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{KNN} \PY{o}{=} \PY{n}{KNeighborsRegressor}\PY{p}{(}\PY{n}{n\PYZus{}neighbors}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{weights}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{distance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{sgdr} \PY{o}{=} \PY{n}{SGDRegressor}\PY{p}{(}\PY{p}{)}

\PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o+ow}{in} \PY{n}{tscv}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{X}\PY{p}{)}\PY{p}{:}
    \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{p}{,} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}
    \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}
    
    \PY{n}{reg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
    \PY{n}{sgdr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
    \PY{n}{KNN}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
    \PY{n}{dtr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
        
    \PY{n}{lin\PYZus{}y\PYZus{}pred} \PY{o}{=} \PY{n}{reg}\PY{o}{.}\PY{n}{predict}\PY{p}{(} \PY{n}{X\PYZus{}test} \PY{p}{)}
    \PY{n}{sgdr\PYZus{}y\PYZus{}pred} \PY{o}{=} \PY{n}{reg}\PY{o}{.}\PY{n}{predict}\PY{p}{(} \PY{n}{X\PYZus{}test} \PY{p}{)}
    \PY{n}{KNN\PYZus{}y\PYZus{}pred} \PY{o}{=} \PY{n}{KNN}\PY{o}{.}\PY{n}{predict}\PY{p}{(} \PY{n}{X\PYZus{}test} \PY{p}{)}
    \PY{n}{dtr\PYZus{}y\PYZus{}pred} \PY{o}{=} \PY{n}{dtr}\PY{o}{.}\PY{n}{predict}\PY{p}{(} \PY{n}{X\PYZus{}test} \PY{p}{)}
       
    \PY{n}{report}\PY{o}{=} \PY{n}{report}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{split}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{n}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{lin\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{lin\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,} 
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}lin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{lin\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,} 
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{KNN\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{KNN\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,} 
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{KNN\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{sgdr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{sgdr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}sgdr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{sgdr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{,}
                            \PY{n}{ignore\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    \PY{n}{n}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}  
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2647265288.py:26:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{115}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{report}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{115}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   split max\_error\_lin    r2\_lin     mae\_lin max\_error\_dtr    r2\_dtr  \textbackslash{}
0    0.0    117.626243  0.328034   38.261251         201.0 -5.708244
1    1.0    110.479698 -0.087663   41.335743         185.5 -0.201106
2    2.0    131.737757  0.201543   37.197652         162.5 -0.223998
3    3.0      75.35347  0.303378   30.180308         141.0  0.642717
4    4.0     106.57009 -0.029476   44.839608         186.0  0.156365
5    5.0    269.824769 -1.243757    63.10851        272.25  0.018453
6    6.0    256.211369 -0.218733   67.161533         457.0  0.415332
7    7.0    321.742342 -0.706415   72.561553        330.75  0.455984
8    8.0    107.045651  0.448654    56.41693         373.0  0.600403
9    9.0    375.546406 -1.214818   84.476243         357.0  0.472119
10  10.0    411.204917 -0.683974  104.053476        673.75  0.539558
11  11.0    244.405506    0.4565   85.043114         402.0 -0.338771
12  12.0    299.241084    0.2489  114.423542        440.25 -1.662804
13  13.0    470.392562 -0.757445  100.797865         555.0 -0.539792
14  14.0    268.757729 -1.635536   95.040038         319.0  0.205367
15  15.0    196.987826 -0.495788   85.129198         325.5  0.428873
16  16.0     549.33151 -1.587005  132.591353         297.0  0.556041
17  17.0    576.885775 -0.965971  140.376984        545.25  0.345491
18  18.0    221.499473 -0.158852  100.449239        501.75   0.52832
19  19.0    242.258319   0.17284   89.246541         333.5  0.759346
20  20.0    679.897925 -1.526867  148.916622        660.75  0.513533
21  21.0    667.970499 -0.992497  162.796156        363.75  0.765406
22  22.0    462.597855  0.325415  172.773057         521.0  0.361893
23  23.0    416.096918  0.440313  130.910336        590.25  0.429083
24  24.0    738.387323 -1.769528  189.595384        714.75  0.015203
25  25.0    712.096664 -0.637265  198.829855         819.0  0.511404
26  26.0    314.685221 -1.628891  138.220251         406.0  -0.31392
27  27.0    782.152888 -0.594455  201.351046        923.25  0.248121
28  28.0    910.790731 -2.103744  225.076973       1026.75  0.333783
29  29.0    323.825369  0.226304  144.554918        813.75  0.244837

       mae\_dtr max\_error\_knn      r2\_knn     mae\_knn max\_error\_sgdr   r2\_sgdr  \textbackslash{}
0    72.469697    272.757052 -160.680248    75.98565     117.626243  0.328034
1    56.469697    144.934956  -35.921591   85.912266     110.479698 -0.087663
2    59.772727    243.266883   -7.745743   54.238756     131.737757  0.201543
3    36.674242    124.902491    -3.54533   42.023597       75.35347  0.303378
4    43.212121    149.018073   -2.280867   67.799754      106.57009 -0.029476
5    34.621212    328.034455   -5.234902   74.891776     269.824769 -1.243757
6    69.136364    387.200523   -7.075969   90.353463     256.211369 -0.218733
7    83.871212    395.380351   -5.860793  104.595399     321.742342 -0.706415
8    86.598485    189.610516   -0.326742   72.183464     107.045651  0.448654
9    69.356061     414.58486   -4.479151  124.154726     375.546406 -1.214818
10  113.719697    553.613615   -4.401499  169.640864     411.204917 -0.683974
11  151.257576    568.223598  -10.951983  160.772028     244.405506    0.4565
12  151.212121    439.634922  -21.827221  168.701113     299.241084    0.2489
13  133.143939    585.646804   -4.117794  136.111555     470.392562 -0.757445
14       106.0    387.420692   -4.136956  204.469584     268.757729 -1.635536
15   87.121212    290.832526   -3.137273  117.277118     196.987826 -0.495788
16  151.234848    732.457068   -9.906182  198.962581      549.33151 -1.587005
17  132.409091    888.867193   -5.742139  197.499625     576.885775 -0.965971
18  148.121212    313.380416   -2.229719  151.358092     221.499473 -0.158852
19   66.060606    372.902088   -1.102243  152.637905     242.258319   0.17284
20   82.098485    813.551918   -6.383126  247.507544     679.897925 -1.526867
21  108.825758    798.502286   -2.373473  226.784082     667.970499 -0.992497
22  203.848485    914.713329   -6.525842   259.98249     462.597855  0.325415
23  186.818182    788.397637   -2.402491  260.552901     416.096918  0.440313
24  209.386364    846.226286   -8.699923  281.675855     738.387323 -1.769528
25  186.787879   1026.878605   -2.651593  253.466707     712.096664 -0.637265
26  225.924242    664.964178   -4.424516  358.307153     314.685221 -1.628891
27  203.037879    995.362026   -6.147302  300.790594     782.152888 -0.594455
28  180.295455   1036.740808   -8.012681  316.776959     910.790731 -2.103744
29  266.151515    951.905643   -0.660607  310.519874     323.825369  0.226304

      mae\_sgdr
0    38.261251
1    41.335743
2    37.197652
3    30.180308
4    44.839608
5     63.10851
6    67.161533
7    72.561553
8     56.41693
9    84.476243
10  104.053476
11   85.043114
12  114.423542
13  100.797865
14   95.040038
15   85.129198
16  132.591353
17  140.376984
18  100.449239
19   89.246541
20  148.916622
21  162.796156
22  172.773057
23  130.910336
24  189.595384
25  198.829855
26  138.220251
27  201.351046
28  225.076973
29  144.554918
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{116}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{max\PYZus{}error\PYZus{}mean\PYZus{}report} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}knn\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}sgdr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}lin\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}dtr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{p}{)}
\PY{n}{m}\PY{o}{=} \PY{l+m+mi}{0}

\PY{n}{max\PYZus{}error\PYZus{}knn\PYZus{}mean}\PY{o}{=} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{KNN\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{max\PYZus{}error\PYZus{}sgdr\PYZus{}mean}\PY{o}{=} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{sgdr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{max\PYZus{}error\PYZus{}lin\PYZus{}mean}\PY{o}{=} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{lin\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{max\PYZus{}error\PYZus{}dtr\PYZus{}mean}\PY{o}{=} \PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}

\PY{n}{max\PYZus{}error\PYZus{}mean\PYZus{}report} \PY{o}{=} \PY{n}{max\PYZus{}error\PYZus{}mean\PYZus{}report}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}knn\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{max\PYZus{}error\PYZus{}knn\PYZus{}mean}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}sgdr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{max\PYZus{}error\PYZus{}sgdr\PYZus{}mean}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}lin\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{max\PYZus{}error\PYZus{}lin\PYZus{}mean}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}dtr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{max\PYZus{}error\PYZus{}dtr\PYZus{}mean}\PY{p}{\PYZcb{}}\PY{p}{,} 
                                \PY{n}{ignore\PYZus{}index}\PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
\PY{n}{m}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}

\PY{n}{max\PYZus{}error\PYZus{}mean\PYZus{}report}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}532847308.py:9: FutureWarning:
The frame.append method is deprecated and will be removed from pandas in a
future version. Use pandas.concat instead.
  max\_error\_mean\_report = max\_error\_mean\_report.append(\{'max\_error\_knn\_mean':
max\_error\_knn\_mean,
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{116}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
  max\_error\_knn\_mean max\_error\_sgdr\_mean max\_error\_lin\_mean max\_error\_dtr\_mean
0         951.905643          323.825369         323.825369             813.75
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{117}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{mae\PYZus{}mean\PYZus{}report} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}knn\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}sgdr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}lin\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}dtr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{p}{)}
\PY{n}{m}\PY{o}{=} \PY{l+m+mi}{0}

\PY{n}{mae\PYZus{}knn\PYZus{}mean}\PY{o}{=} \PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{KNN\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{mae\PYZus{}sgdr\PYZus{}mean}\PY{o}{=} \PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{sgdr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{mae\PYZus{}lin\PYZus{}mean}\PY{o}{=} \PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{lin\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\PY{n}{mae\PYZus{}dtr\PYZus{}mean}\PY{o}{=} \PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}

\PY{n}{mae\PYZus{}mean\PYZus{}report} \PY{o}{=} \PY{n}{mae\PYZus{}mean\PYZus{}report}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}knn\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{mae\PYZus{}knn\PYZus{}mean}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}sgdr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mae\PYZus{}sgdr\PYZus{}mean}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}lin\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mae\PYZus{}lin\PYZus{}mean}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}dtr\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mae\PYZus{}dtr\PYZus{}mean}\PY{p}{\PYZcb{}}\PY{p}{,}
                                \PY{n}{ignore\PYZus{}index}\PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
\PY{n}{m}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}

\PY{n}{mae\PYZus{}mean\PYZus{}report}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2850408021.py:9:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  mae\_mean\_report = mae\_mean\_report.append(\{'mae\_knn\_mean': mae\_knn\_mean,
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{117}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
  mae\_knn\_mean mae\_sgdr\_mean mae\_lin\_mean mae\_dtr\_mean
0   310.519874    144.554918   144.554918   266.151515
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{summary}{%
\subsubsection{Summary:}\label{summary}}

In general the TimeSerialSplit methos is not very suitable for testing
the models. The relatively good model is DecisionTreeRegressor. R2 score
is 0.244, the max error mean is 813.75, is high. So as the MeanAbsolute
Error, 266.152.

    \hypertarget{visulization---timeserialssplit-dtr}{%
\subsubsection{Visulization - TimeSerialsSplit,
DTR}\label{visulization---timeserialssplit-dtr}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{118}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} training test split manual\PYZhy{} 3/4 training, validation on 1/4}
\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{X\PYZus{}scaled}\PY{o}{.}\PY{n}{iloc}\PY{p}{[} \PY{p}{:} \PY{n+nb}{int}\PY{p}{(}\PY{l+m+mf}{0.75}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{X\PYZus{}scaled}\PY{p}{)}\PY{p}{)} \PY{p}{]}\PY{p}{,} \PY{n}{X\PYZus{}scaled}\PY{o}{.}\PY{n}{iloc}\PY{p}{[} \PY{n+nb}{int}\PY{p}{(}\PY{l+m+mf}{0.75}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{X\PYZus{}scaled}\PY{p}{)}\PY{p}{)} \PY{p}{:} \PY{p}{]}
\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[} \PY{p}{:} \PY{n+nb}{int}\PY{p}{(}\PY{l+m+mf}{0.75}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{)} \PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[} \PY{n+nb}{int}\PY{p}{(}\PY{l+m+mf}{0.75}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{)} \PY{p}{:} \PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{119}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k+kn}{import} \PY{n}{DecisionTreeRegressor}

\PY{n}{dtr} \PY{o}{=} \PY{n}{DecisionTreeRegressor}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{dtr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{119}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
DecisionTreeRegressor(random\_state=0)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{120}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{preds\PYZus{}dtr}\PY{o}{=} \PY{n}{dtr}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
\PY{n}{preds\PYZus{}dtr}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{120}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([ 893.  ,  858.  ,  893.  ,  893.  ,  893.  , 1233.  , 1233.  ,
        893.  ,  708.  ,  893.  ,  893.  ,  893.  , 1233.  ,  874.  ,
        893.  ,  824.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  824.  ,  839.  ,  839.  , 1894.5 , 1869.75,
        829.  ,  824.  ,  824.  ,  839.  ,  839.  , 1894.5 , 1869.75,
        829.  ,  824.  ,  831.  ,  839.  ,  839.  , 1894.5 , 1869.75,
        829.  ,  824.  ,  831.  ,  839.  ,  839.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1869.75,
        829.  ,  824.  ,  831.  ,  839.  ,  839.  , 1894.5 , 1869.75,
        829.  ,  824.  , 1198.5 ,  839.  ,  839.  , 1894.5 , 1869.75,
        829.  ,  824.  ,  824.  ,  839.  ,  839.  , 1311.  , 1264.5 ,
        708.  ,  708.  ,  858.  ,  858.  ,  858.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        829.  ,  824.  ,  824.  ,  839.  ,  839.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  863.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1264.5 ,
        829.  ,  858.  ,  858.  ,  858.  ,  858.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1869.75,
        829.  ,  824.  ,  824.  ,  839.  ,  839.  , 1894.5 , 1894.5 ,
        856.  , 1146.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ,  874.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  , 1146.  ,  874.  ,  874.  ,  874.  , 1894.5 , 1894.5 ,
        856.  ])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{121}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{dtr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{121}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
DecisionTreeRegressor(random\_state=0)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{122}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}train}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{122}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
     holiday  day\_of\_week     rol\_7    rol\_10
0        0.0     0.333333  0.000000  0.021102
1        0.0     0.500000  0.001806  0.011760
2        0.0     0.666667  0.000570  0.000915
3        0.0     0.833333  0.002947  0.000261
4        0.0     1.000000  0.000666  0.000000
..       {\ldots}          {\ldots}       {\ldots}       {\ldots}
772      0.0     0.666667  0.594899  0.588410
773      0.0     0.833333  0.596040  0.561983
774      0.0     1.000000  0.596515  0.562506
775      0.0     0.000000  0.599510  0.592069
776      0.0     0.166667  0.602505  0.624179

[777 rows x 4 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{123}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{y\PYZus{}train}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{123}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
29      117.0
30      109.0
31       86.0
32      102.0
33       86.0
        {\ldots}
801     858.0
802     863.0
803     893.0
804    1342.5
805    1342.5
Name: y, Length: 777, dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{124}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{comp\PYZus{}dtr}\PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n}{X}\PY{o}{.}\PY{n}{index}\PY{p}{)}
\PY{n}{comp\PYZus{}dtr}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{124}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Empty DataFrame
Columns: []
Index: [2019-01-30 00:00:00, 2019-01-31 00:00:00, 2019-02-01 00:00:00,
2019-02-02 00:00:00, 2019-02-03 00:00:00, 2019-02-04 00:00:00, 2019-02-05
00:00:00, 2019-02-06 00:00:00, 2019-02-07 00:00:00, 2019-02-08 00:00:00,
2019-02-09 00:00:00, 2019-02-10 00:00:00, 2019-02-11 00:00:00, 2019-02-12
00:00:00, 2019-02-13 00:00:00, 2019-02-14 00:00:00, 2019-02-15 00:00:00,
2019-02-16 00:00:00, 2019-02-17 00:00:00, 2019-02-18 00:00:00, 2019-02-19
00:00:00, 2019-02-20 00:00:00, 2019-02-21 00:00:00, 2019-02-22 00:00:00,
2019-02-23 00:00:00, 2019-02-24 00:00:00, 2019-02-25 00:00:00, 2019-02-26
00:00:00, 2019-02-27 00:00:00, 2019-02-28 00:00:00, 2019-03-01 00:00:00,
2019-03-02 00:00:00, 2019-03-03 00:00:00, 2019-03-04 00:00:00, 2019-03-05
00:00:00, 2019-03-06 00:00:00, 2019-03-07 00:00:00, 2019-03-08 00:00:00,
2019-03-09 00:00:00, 2019-03-10 00:00:00, 2019-03-11 00:00:00, 2019-03-12
00:00:00, 2019-03-13 00:00:00, 2019-03-14 00:00:00, 2019-03-15 00:00:00,
2019-03-16 00:00:00, 2019-03-17 00:00:00, 2019-03-18 00:00:00, 2019-03-19
00:00:00, 2019-03-20 00:00:00, 2019-03-21 00:00:00, 2019-03-22 00:00:00,
2019-03-23 00:00:00, 2019-03-24 00:00:00, 2019-03-25 00:00:00, 2019-03-26
00:00:00, 2019-03-27 00:00:00, 2019-03-28 00:00:00, 2019-03-29 00:00:00,
2019-03-30 00:00:00, 2019-03-31 00:00:00, 2019-04-01 00:00:00, 2019-04-02
00:00:00, 2019-04-03 00:00:00, 2019-04-04 00:00:00, 2019-04-05 00:00:00,
2019-04-06 00:00:00, 2019-04-07 00:00:00, 2019-04-08 00:00:00, 2019-04-09
00:00:00, 2019-04-10 00:00:00, 2019-04-11 00:00:00, 2019-04-12 00:00:00,
2019-04-13 00:00:00, 2019-04-14 00:00:00, 2019-04-15 00:00:00, 2019-04-16
00:00:00, 2019-04-17 00:00:00, 2019-04-18 00:00:00, 2019-04-19 00:00:00,
2019-04-20 00:00:00, 2019-04-21 00:00:00, 2019-04-22 00:00:00, 2019-04-23
00:00:00, 2019-04-24 00:00:00, 2019-04-25 00:00:00, 2019-04-26 00:00:00,
2019-04-27 00:00:00, 2019-04-28 00:00:00, 2019-04-29 00:00:00, 2019-04-30
00:00:00, 2019-05-01 00:00:00, 2019-05-02 00:00:00, 2019-05-03 00:00:00,
2019-05-04 00:00:00, 2019-05-05 00:00:00, 2019-05-06 00:00:00, 2019-05-07
00:00:00, 2019-05-08 00:00:00, 2019-05-09 00:00:00, {\ldots}]

[1037 rows x 0 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{125}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{comp\PYZus{}dtr}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y\PYZus{}true}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{values}
\PY{n}{comp\PYZus{}dtr}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y\PYZus{}true}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{125}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
date
2019-01-30     117.0
2019-01-31     109.0
2019-02-01      86.0
2019-02-02     102.0
2019-02-03      86.0
               {\ldots}
2021-11-27    1141.0
2021-11-28    1141.0
2021-11-29    1738.5
2021-11-30    1738.5
2021-12-01    1156.0
Name: y\_true, Length: 1037, dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{126}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} fill the prediction blank positions with nan, concat with \PYZsq{}preds\PYZsq{} values  }
\PY{n}{preds\PYZus{}dtr} \PY{o}{=} \PY{p}{[} \PY{n}{np}\PY{o}{.}\PY{n}{nan} \PY{p}{]} \PY{o}{*} \PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}  \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{preds\PYZus{}dtr}\PY{p}{)}
\PY{n}{preds\PYZus{}dtr}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{126}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 893.0,
 858.0,
 893.0,
 893.0,
 893.0,
 1233.0,
 1233.0,
 893.0,
 708.0,
 893.0,
 893.0,
 893.0,
 1233.0,
 874.0,
 893.0,
 824.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 824.0,
 839.0,
 839.0,
 1894.5,
 1869.75,
 829.0,
 824.0,
 824.0,
 839.0,
 839.0,
 1894.5,
 1869.75,
 829.0,
 824.0,
 831.0,
 839.0,
 839.0,
 1894.5,
 1869.75,
 829.0,
 824.0,
 831.0,
 839.0,
 839.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1869.75,
 829.0,
 824.0,
 831.0,
 839.0,
 839.0,
 1894.5,
 1869.75,
 829.0,
 824.0,
 1198.5,
 839.0,
 839.0,
 1894.5,
 1869.75,
 829.0,
 824.0,
 824.0,
 839.0,
 839.0,
 1311.0,
 1264.5,
 708.0,
 708.0,
 858.0,
 858.0,
 858.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1894.5,
 829.0,
 824.0,
 824.0,
 839.0,
 839.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 863.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1264.5,
 829.0,
 858.0,
 858.0,
 858.0,
 858.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 1894.5,
 856.0,
 874.0,
 874.0,
 874.0,
 874.0,
 1894.5,
 {\ldots}]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{127}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} add preds into the df}
\PY{n}{comp\PYZus{}dtr}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{preds}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{preds\PYZus{}dtr}
\PY{n}{comp\PYZus{}dtr}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{127}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
            y\_true   preds
date
2019-01-30   117.0     NaN
2019-01-31   109.0     NaN
2019-02-01    86.0     NaN
2019-02-02   102.0     NaN
2019-02-03    86.0     NaN
{\ldots}            {\ldots}     {\ldots}
2021-11-27  1141.0   874.0
2021-11-28  1141.0   874.0
2021-11-29  1738.5  1894.5
2021-11-30  1738.5  1894.5
2021-12-01  1156.0   856.0

[1037 rows x 2 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{128}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{comp\PYZus{}dtr}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{128}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<AxesSubplot:xlabel='date'>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_155_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{129}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}TBC }
\PY{c+c1}{\PYZsh{} SVM\PYZhy{} support vector machines \PYZhy{} for classification }
\PY{c+c1}{\PYZsh{} assemble model \PYZhy{} random forest and ingredient boosting }
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{permutation-feature-importance}{%
\subsection{Permutation feature
importance}\label{permutation-feature-importance}}

    \hypertarget{pfi-for-linear-regression}{%
\subsubsection{PFI for Linear
Regression}\label{pfi-for-linear-regression}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{130}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{inspection} \PY{k+kn}{import} \PY{n}{permutation\PYZus{}importance}
\PY{n}{r} \PY{o}{=} \PY{n}{permutation\PYZus{}importance}\PY{p}{(}\PY{n}{reg}\PY{p}{,} \PY{n}{X\PYZus{}scaled}\PY{p}{,} \PY{n}{y}\PY{p}{,}
                           \PY{n}{n\PYZus{}repeats}\PY{o}{=}\PY{l+m+mi}{30}\PY{p}{,}
                           \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{r}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{130}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\{'importances\_mean': array([ 0.04804593,  0.02671736,  0.00123461, -0.0002236
]),
 'importances\_std': array([1.04803717e-02, 2.50660393e-03, 3.80235387e-05,
6.99869129e-06]),
 'importances': array([[ 0.04016066,  0.05100465,  0.05709322,  0.04840541,
0.04716162,
          0.04934551,  0.03388571,  0.060213  ,  0.04928315,  0.0636846 ,
          0.04556869,  0.0598287 ,  0.04847029,  0.05358602,  0.02820517,
          0.05992899,  0.06094977,  0.06679474,  0.03226854,  0.05150788,
          0.04411458,  0.04818266,  0.04823217,  0.05653655,  0.04108443,
          0.03910106,  0.05281361,  0.04181053,  0.02102903,  0.041127  ],
        [ 0.02989041,  0.02458507,  0.02538282,  0.02786155,  0.02080248,
          0.02763258,  0.02667661,  0.02791462,  0.02811004,  0.02815151,
          0.02577335,  0.03019582,  0.02511723,  0.02627522,  0.02408865,
          0.02972488,  0.02694715,  0.02882079,  0.02812125,  0.02574807,
          0.03426204,  0.02577286,  0.02634679,  0.0272853 ,  0.02367242,
          0.02758179,  0.026523  ,  0.0231438 ,  0.02453475,  0.02457789],
        [ 0.00119951,  0.00129761,  0.00123362,  0.00126686,  0.00118281,
          0.00126683,  0.00128228,  0.00121758,  0.00124818,  0.00127101,
          0.0012898 ,  0.00116873,  0.00119309,  0.00125288,  0.00124711,
          0.00125397,  0.00129974,  0.00120776,  0.00121253,  0.00127927,
          0.00123642,  0.00123483,  0.00120671,  0.00127222,  0.00116141,
          0.00119944,  0.00121926,  0.00122611,  0.00118182,  0.00122887],
        [-0.00021783, -0.00023532, -0.00022206, -0.00023057, -0.00021347,
         -0.00022965, -0.00023162, -0.00022003, -0.00022582, -0.00023039,
         -0.00023288, -0.00021129, -0.00021698, -0.00022667, -0.00022507,
         -0.00022878, -0.00023709, -0.00021859, -0.00022028, -0.00023085,
         -0.00022469, -0.00022443, -0.00021723, -0.00022927, -0.00020959,
         -0.00021795, -0.00022134, -0.00022134, -0.00021501, -0.00022183]])\}
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{131}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{r}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{importances\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{131}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([ 0.04804593,  0.02671736,  0.00123461, -0.0002236 ])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{132}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{r}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{importances\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=} \PY{n}{X\PYZus{}scaled}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{132}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<AxesSubplot:>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_161_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{133}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{scoring} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}absolute\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}squared\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{r\PYZus{}multi} \PY{o}{=} \PY{n}{permutation\PYZus{}importance}\PY{p}{(}
    \PY{n}{reg}\PY{p}{,} \PY{n}{X\PYZus{}scaled}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{n\PYZus{}repeats}\PY{o}{=}\PY{l+m+mi}{30}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{n}{scoring}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{134}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{sklearn} 
\PY{n}{sklearn}\PY{o}{.}\PY{n}{metrics}\PY{o}{.}\PY{n}{SCORERS}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{134}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
dict\_keys(['explained\_variance', 'r2', 'max\_error', 'neg\_median\_absolute\_error',
'neg\_mean\_absolute\_error', 'neg\_mean\_absolute\_percentage\_error',
'neg\_mean\_squared\_error', 'neg\_mean\_squared\_log\_error',
'neg\_root\_mean\_squared\_error', 'neg\_mean\_poisson\_deviance',
'neg\_mean\_gamma\_deviance', 'accuracy', 'top\_k\_accuracy', 'roc\_auc',
'roc\_auc\_ovr', 'roc\_auc\_ovo', 'roc\_auc\_ovr\_weighted', 'roc\_auc\_ovo\_weighted',
'balanced\_accuracy', 'average\_precision', 'neg\_log\_loss', 'neg\_brier\_score',
'adjusted\_rand\_score', 'rand\_score', 'homogeneity\_score', 'completeness\_score',
'v\_measure\_score', 'mutual\_info\_score', 'adjusted\_mutual\_info\_score',
'normalized\_mutual\_info\_score', 'fowlkes\_mallows\_score', 'precision',
'precision\_macro', 'precision\_micro', 'precision\_samples', 'precision\_weighted',
'recall', 'recall\_macro', 'recall\_micro', 'recall\_samples', 'recall\_weighted',
'f1', 'f1\_macro', 'f1\_micro', 'f1\_samples', 'f1\_weighted', 'jaccard',
'jaccard\_macro', 'jaccard\_micro', 'jaccard\_samples', 'jaccard\_weighted'])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{135}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{r\PYZus{}multi}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}absolute\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{135}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\{'importances\_mean': array([ 2.27647439,  0.32774949,  0.03523224,
-0.00638779]),
 'importances\_std': array([1.10866055e+00, 1.95548344e-01, 3.54692068e-03,
6.22710476e-04]),
 'importances': array([[ 1.16898456,  3.00820938,  1.69042776,  2.42989607,
1.85664027,
          2.23250532,  1.55827088,  2.8016117 ,  2.94673929,  4.20473617,
          1.55841225,  3.26083912,  3.42585893,  2.52615009,  0.66839724,
          2.4893906 ,  3.96161232,  4.19355705, -0.14507649,  1.75674405,
          0.83477152,  2.79830925,  2.19012151,  3.74169211,  2.74297504,
          1.3301615 ,  3.28836217,  2.12820001,  0.28931447,  1.35641761],
        [ 0.50939395,  0.01575278,  0.33947051,  0.03775701,  0.01708474,
          0.21729521,  0.44032829,  0.37704565,  0.34209136,  0.39548035,
          0.24024659,  0.65365867,  0.70105014,  0.01998424,  0.72645216,
          0.32156501,  0.43402039,  0.37361644,  0.1741949 ,  0.34285544,
          0.43168233,  0.41349844,  0.36075321,  0.48884079,  0.17445765,
          0.5349791 ,  0.18119253,  0.10079871,  0.06399664,  0.40294141],
        [ 0.03000048,  0.03976267,  0.03294251,  0.0347566 ,  0.03165172,
          0.03409734,  0.03488697,  0.04206165,  0.03289896,  0.04304141,
          0.03670726,  0.03184113,  0.03296121,  0.04055716,  0.03194295,
          0.03262456,  0.03873455,  0.03605907,  0.03103153,  0.03567698,
          0.04094384,  0.03794553,  0.03396078,  0.0382719 ,  0.03384513,
          0.02988041,  0.03753462,  0.03191467,  0.03504816,  0.03338552],
        [-0.00546646, -0.00708547, -0.00597109, -0.00636902, -0.00578163,
         -0.00620827, -0.00635196, -0.00766977, -0.00603714, -0.0077831 ,
         -0.00651751, -0.00573692, -0.00619183, -0.00715442, -0.005821  ,
         -0.00584029, -0.00721791, -0.00648183, -0.00563867, -0.00654669,
         -0.00734214, -0.00691372, -0.00619347, -0.00689698, -0.0060081 ,
         -0.00555207, -0.00680511, -0.00573302, -0.00619534, -0.00612264]])\}
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{136}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{r\PYZus{}multi}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}absolute\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{importances\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{136}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([ 2.27647439,  0.32774949,  0.03523224, -0.00638779])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{137}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pd}\PY{o}{.}\PY{n}{Series} \PY{p}{(}\PY{n}{data}\PY{o}{=} \PY{n}{r\PYZus{}multi}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}absolute\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{importances\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{X\PYZus{}scaled}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{137}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
holiday        2.276474
day\_of\_week    0.327749
rol\_7          0.035232
rol\_10        -0.006388
dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{138}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} how much neg\PYZus{}mean\PYZus{}absolute\PYZus{}error go down if I replace the feature with noise/ premute all the rows}
\PY{n}{pd}\PY{o}{.}\PY{n}{Series} \PY{p}{(}\PY{n}{data}\PY{o}{=} \PY{n}{r\PYZus{}multi}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}absolute\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{importances\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{X\PYZus{}scaled}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{138}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<AxesSubplot:>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_167_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{pfi-for-dtr}{%
\subsubsection{PFI for DTR}\label{pfi-for-dtr}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{139}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Compare the same metric with different models}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{inspection} \PY{k+kn}{import} \PY{n}{permutation\PYZus{}importance}
\PY{n}{r} \PY{o}{=} \PY{n}{permutation\PYZus{}importance}\PY{p}{(}\PY{n}{dtr}\PY{p}{,} \PY{n}{X\PYZus{}scaled}\PY{p}{,} \PY{n}{y}\PY{p}{,}
                           \PY{n}{n\PYZus{}repeats}\PY{o}{=}\PY{l+m+mi}{30}\PY{p}{,}
                           \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{140}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{r}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{140}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\{'importances\_mean': array([0.02246261, 0.46125278, 0.60436   , 0.54944485]),
 'importances\_std': array([0.00327321, 0.02941315, 0.02515922, 0.03140804]),
 'importances': array([[0.02326028, 0.02656711, 0.02175504, 0.02702893,
0.02436126,
         0.02346443, 0.01964894, 0.0220119 , 0.0209185 , 0.02472089,
         0.02721358, 0.01797763, 0.0233154 , 0.02239328, 0.0238649 ,
         0.02385154, 0.02149534, 0.01928857, 0.02314534, 0.02554174,
         0.02143446, 0.01814226, 0.02402153, 0.01993784, 0.02396712,
         0.0170441 , 0.02319721, 0.02382803, 0.0124409 , 0.02804012],
        [0.38617614, 0.45824593, 0.46356417, 0.47259377, 0.47897307,
         0.47319714, 0.44852208, 0.43321203, 0.49467546, 0.44550335,
         0.45828683, 0.48332295, 0.41828816, 0.4609932 , 0.47432093,
         0.4766402 , 0.48207053, 0.48627316, 0.48168975, 0.4375655 ,
         0.48906576, 0.41244488, 0.47843541, 0.49498827, 0.50290718,
         0.43307746, 0.48090965, 0.46209126, 0.39170839, 0.47784093],
        [0.59428775, 0.58846405, 0.59489706, 0.61199707, 0.63849235,
         0.61423634, 0.59945636, 0.59656632, 0.62902842, 0.62065846,
         0.59646095, 0.59866962, 0.59724467, 0.61438624, 0.56783147,
         0.63647301, 0.65837284, 0.57924969, 0.64067737, 0.58867693,
         0.5854453 , 0.60611515, 0.59082138, 0.58087349, 0.54929238,
         0.58097796, 0.60195526, 0.57977052, 0.6446214 , 0.64480021],
        [0.50275613, 0.55857426, 0.54613019, 0.58408623, 0.5461164 ,
         0.56105103, 0.58180456, 0.58199209, 0.57822114, 0.57030535,
         0.58565427, 0.52923373, 0.53533247, 0.51930759, 0.55203903,
         0.56932992, 0.59847419, 0.5012934 , 0.52904846, 0.60196229,
         0.56806183, 0.55739165, 0.52333383, 0.54201939, 0.46054947,
         0.52738408, 0.55322605, 0.54076618, 0.51037627, 0.56752413]])\}
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{141}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{r}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{importances\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{141}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([0.02246261, 0.46125278, 0.60436   , 0.54944485])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{142}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{r\PYZus{}multi}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}absolute\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{importances\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{142}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([ 2.27647439,  0.32774949,  0.03523224, -0.00638779])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{143}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pd}\PY{o}{.}\PY{n}{Series} \PY{p}{(}\PY{n}{data}\PY{o}{=} \PY{n}{r\PYZus{}multi}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}absolute\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{importances\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{X\PYZus{}scaled}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{143}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
holiday        2.276474
day\_of\_week    0.327749
rol\_7          0.035232
rol\_10        -0.006388
dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{144}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{data}\PY{o}{=} \PY{n}{r\PYZus{}multi}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neg\PYZus{}mean\PYZus{}absolute\PYZus{}error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{importances\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{X\PYZus{}scaled}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{144}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<AxesSubplot:>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_174_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{feature-creation--combine-features-to-creat-a-new-feature}{%
\subsubsection{Feature Creation- Combine features to creat a new
feature}\label{feature-creation--combine-features-to-creat-a-new-feature}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{145}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k+kn}{import} \PY{n}{PolynomialFeatures}

\PY{n}{poly} \PY{o}{=} \PY{n}{PolynomialFeatures}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{x\PYZus{}poly}\PY{o}{=} \PY{n}{poly}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}scaled}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{146}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{poly}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names\PYZus{}out}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{146}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array(['1', 'holiday', 'day\_of\_week', 'rol\_7', 'rol\_10', 'holiday\^{}2',
       'holiday day\_of\_week', 'holiday rol\_7', 'holiday rol\_10',
       'day\_of\_week\^{}2', 'day\_of\_week rol\_7', 'day\_of\_week rol\_10',
       'rol\_7\^{}2', 'rol\_7 rol\_10', 'rol\_10\^{}2'], dtype=object)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{147}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{x\PYZus{}poly}\PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{x\PYZus{}poly}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{poly}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names\PYZus{}out}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\PY{n}{x\PYZus{}poly}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{147}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
        1  holiday  day\_of\_week     rol\_7    rol\_10  holiday\^{}2  \textbackslash{}
0     1.0      0.0     0.333333  0.000000  0.021102        0.0
1     1.0      0.0     0.500000  0.001806  0.011760        0.0
2     1.0      0.0     0.666667  0.000570  0.000915        0.0
3     1.0      0.0     0.833333  0.002947  0.000261        0.0
4     1.0      0.0     1.000000  0.000666  0.000000        0.0
{\ldots}   {\ldots}      {\ldots}          {\ldots}       {\ldots}       {\ldots}        {\ldots}
1032  1.0      0.0     0.833333  0.857693  0.794630        0.0
1033  1.0      0.0     1.000000  0.857693  0.794042        0.0
1034  1.0      0.0     0.000000  0.858976  0.832489        0.0
1035  1.0      0.0     0.166667  0.860260  0.871917        0.0
1036  1.0      0.0     0.333333  0.863017  0.872897        0.0

      holiday day\_of\_week  holiday rol\_7  holiday rol\_10  day\_of\_week\^{}2  \textbackslash{}
0                     0.0            0.0             0.0       0.111111
1                     0.0            0.0             0.0       0.250000
2                     0.0            0.0             0.0       0.444444
3                     0.0            0.0             0.0       0.694444
4                     0.0            0.0             0.0       1.000000
{\ldots}                   {\ldots}            {\ldots}             {\ldots}            {\ldots}
1032                  0.0            0.0             0.0       0.694444
1033                  0.0            0.0             0.0       1.000000
1034                  0.0            0.0             0.0       0.000000
1035                  0.0            0.0             0.0       0.027778
1036                  0.0            0.0             0.0       0.111111

      day\_of\_week rol\_7  day\_of\_week rol\_10       rol\_7\^{}2  rol\_7 rol\_10  \textbackslash{}
0              0.000000            0.007034  0.000000e+00  0.000000e+00
1              0.000903            0.005880  3.263334e-06  2.124356e-05
2              0.000380            0.000610  3.254294e-07  5.217717e-07
3              0.002456            0.000218  8.687158e-06  7.702345e-07
4              0.000666            0.000000  4.429456e-07  0.000000e+00
{\ldots}                 {\ldots}                 {\ldots}           {\ldots}           {\ldots}
1032           0.714744            0.662191  7.356372e-01  6.815483e-01
1033           0.857693            0.794042  7.356372e-01  6.810440e-01
1034           0.000000            0.000000  7.378406e-01  7.150889e-01
1035           0.143377            0.145320  7.400473e-01  7.500755e-01
1036           0.287672            0.290966  7.447988e-01  7.533253e-01

          rol\_10\^{}2
0     4.453006e-04
1     1.382908e-04
2     8.365738e-07
3     6.829174e-08
4     0.000000e+00
{\ldots}            {\ldots}
1032  6.314364e-01
1033  6.305023e-01
1034  6.930387e-01
1035  7.602395e-01
1036  7.619494e-01

[1037 rows x 15 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{148}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{x\PYZus{}poly}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{148}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<AxesSubplot:>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_179_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{use-permutation-to-see-the-new-features-importance}{%
\subsubsection{Use permutation to see the new features
importance}\label{use-permutation-to-see-the-new-features-importance}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{149}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} train test split\PYZhy{} train the feature importance (1/3, 2/3). }
\PY{c+c1}{\PYZsh{} evaluate the importance on the other }
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k+kn}{import} \PY{n}{ShuffleSplit}

\PY{n}{rs} \PY{o}{=} \PY{n}{ShuffleSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.33}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}

\PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o+ow}{in} \PY{n}{rs}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{X}\PY{p}{)}\PY{p}{:}
    \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{x\PYZus{}poly}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{p}{,} \PY{n}{x\PYZus{}poly}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}
    \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{fit-x_poly-onto-dtr}{%
\subsubsection{Fit X\_poly onto dtr}\label{fit-x_poly-onto-dtr}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{150}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k+kn}{import} \PY{n}{DecisionTreeRegressor}
\PY{n}{dtr} \PY{o}{=} \PY{n}{DecisionTreeRegressor}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}

\PY{n}{dtr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{150}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
DecisionTreeRegressor(random\_state=0)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{151}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}train}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{151}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
        1  holiday  day\_of\_week     rol\_7    rol\_10  holiday\^{}2  \textbackslash{}
961   1.0      0.0     0.666667  0.742554  0.782037        0.0
564   1.0      0.0     1.000000  0.441444  0.414791        0.0
900   1.0      0.0     1.000000  0.687600  0.648613        0.0
144   1.0      0.0     1.000000  0.117706  0.110803        0.0
652   1.0      0.0     0.500000  0.544983  0.530134        0.0
{\ldots}   {\ldots}      {\ldots}          {\ldots}       {\ldots}       {\ldots}        {\ldots}
1007  1.0      0.0     0.166667  0.667063  0.731715        0.0
181   1.0      0.0     0.166667  0.155927  0.162219        0.0
785   1.0      0.0     0.500000  0.595470  0.594813        0.0
872   1.0      0.0     1.000000  0.678472  0.637964        0.0
853   1.0      0.0     0.166667  0.783675  0.770751        0.0

      holiday day\_of\_week  holiday rol\_7  holiday rol\_10  day\_of\_week\^{}2  \textbackslash{}
961                   0.0            0.0             0.0       0.444444
564                   0.0            0.0             0.0       1.000000
900                   0.0            0.0             0.0       1.000000
144                   0.0            0.0             0.0       1.000000
652                   0.0            0.0             0.0       0.250000
{\ldots}                   {\ldots}            {\ldots}             {\ldots}            {\ldots}
1007                  0.0            0.0             0.0       0.027778
181                   0.0            0.0             0.0       0.027778
785                   0.0            0.0             0.0       0.250000
872                   0.0            0.0             0.0       1.000000
853                   0.0            0.0             0.0       0.027778

      day\_of\_week rol\_7  day\_of\_week rol\_10   rol\_7\^{}2  rol\_7 rol\_10  rol\_10\^{}2
961            0.495036            0.521358  0.551387      0.580705  0.611582
564            0.441444            0.414791  0.194873      0.183107  0.172052
900            0.687600            0.648613  0.472793      0.445986  0.420699
144            0.117706            0.110803  0.013855      0.013042  0.012277
652            0.272492            0.265067  0.297007      0.288914  0.281042
{\ldots}                 {\ldots}                 {\ldots}       {\ldots}           {\ldots}       {\ldots}
1007           0.111177            0.121953  0.444973      0.488100  0.535407
181            0.025988            0.027036  0.024313      0.025294  0.026315
785            0.297735            0.297406  0.354584      0.354193  0.353802
872            0.678472            0.637964  0.460324      0.432841  0.406998
853            0.130613            0.128458  0.614147      0.604018  0.594057

[694 rows x 15 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{152}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{y\PYZus{}train}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{152}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
990     1085.00
593      648.00
929     1027.00
173      252.00
681      766.00
         {\ldots}
1036    1110.00
210      453.00
814      880.00
901      969.00
882     2108.25
Name: y, Length: 694, dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{153}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Compare the same metric with different models}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{inspection} \PY{k+kn}{import} \PY{n}{permutation\PYZus{}importance}
\PY{n}{r} \PY{o}{=} \PY{n}{permutation\PYZus{}importance}\PY{p}{(}\PY{n}{dtr}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{,}
                           \PY{n}{n\PYZus{}repeats}\PY{o}{=}\PY{l+m+mi}{30}\PY{p}{,}
                           \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{r} 
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{153}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\{'importances\_mean': array([ 0.00000000e+00,  1.47399675e-03,  1.59611891e-01,
7.95406609e-03,
         7.07265924e-01,  9.88117359e-04,  0.00000000e+00,  2.88021610e-02,
         1.81395572e-03,  3.10075986e-04,  2.54548220e-02,  2.23266728e-01,
         8.34829017e-02,  2.76899061e-01, -4.20726635e-04]),
 'importances\_std': array([0.        , 0.00054711, 0.04120171, 0.00719999,
0.06856634,
        0.00222082, 0.        , 0.00668212, 0.00060106, 0.00038054,
        0.00841077, 0.0227025 , 0.01536443, 0.0291124 , 0.00160876]),
 'importances': array([[ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [ 8.60458736e-04,  1.42813736e-03,  1.42813736e-03,
          1.42813736e-03,  3.60848561e-03,  2.63281439e-03,
          1.70526282e-03,  1.42813736e-03,  1.42813736e-03,
          1.42813736e-03,  1.42813736e-03,  1.42813736e-03,
          1.42813736e-03,  1.42813736e-03,  1.42813736e-03,
          1.42813736e-03,  1.42813736e-03,  8.60458736e-04,
          1.42813736e-03,  1.42813736e-03,  1.42813736e-03,
          1.42813736e-03,  1.70526282e-03,  1.42813736e-03,
          1.42813736e-03,  1.42813736e-03,  1.42813736e-03,
          1.42813736e-03,  1.42813736e-03,  0.00000000e+00],
        [ 1.85448042e-01,  1.26919452e-01,  1.71967555e-01,
          1.35644145e-01,  1.62869641e-01,  1.44799323e-01,
          1.73832056e-01,  1.11697482e-01,  2.17478905e-01,
          1.29107015e-01,  1.29075290e-01,  2.05896817e-01,
          2.50878393e-01,  1.44322310e-01,  1.17354806e-01,
          1.77142694e-01,  1.27187218e-01,  1.91807917e-01,
          1.79137380e-01,  1.44888739e-01,  1.01178246e-01,
          2.21685532e-01,  5.26804900e-02,  1.36590774e-01,
          1.78370405e-01,  1.97849312e-01,  1.31782299e-01,
          1.48568568e-01,  1.81350813e-01,  2.10845109e-01],
        [ 2.69463237e-03,  4.80094960e-03,  1.11681267e-02,
          4.96809774e-03,  2.28059176e-03,  2.60933556e-02,
          2.31325513e-03,  5.80490358e-03,  1.41792237e-04,
          1.63632150e-03,  8.94429481e-03,  3.77041282e-03,
          3.63088007e-03,  7.20141932e-03,  8.72053945e-03,
          8.08160711e-03,  2.34927580e-02,  5.62209774e-03,
          2.02523399e-02,  6.21673456e-03,  2.05692093e-02,
          9.09301201e-03,  9.26789083e-03,  3.60018523e-03,
          7.85081793e-03,  3.68553097e-03,  2.89856203e-03,
         -8.59877842e-04,  2.28087661e-02,  1.87277618e-03],
        [ 7.48376952e-01,  6.22899569e-01,  8.06413184e-01,
          8.14700557e-01,  6.07889677e-01,  6.45897712e-01,
          5.97100694e-01,  7.86535716e-01,  6.42805005e-01,
          6.66480358e-01,  6.17249589e-01,  7.74398232e-01,
          7.13867192e-01,  6.98101265e-01,  5.95830531e-01,
          7.51734924e-01,  6.77113662e-01,  7.05977131e-01,
          6.45792074e-01,  7.14358124e-01,  7.08207801e-01,
          6.94724371e-01,  6.85866643e-01,  7.37077333e-01,
          6.41018371e-01,  7.71109192e-01,  7.86170414e-01,
          7.82350724e-01,  8.43390312e-01,  7.34540410e-01],
        [ 0.00000000e+00,  7.58344154e-03,  1.69260725e-03,
          0.00000000e+00,  0.00000000e+00,  1.00818098e-03,
          7.43463889e-06,  0.00000000e+00, -1.26703826e-03,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          4.40983958e-03,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00, -1.26703826e-03,  0.00000000e+00,
          1.00818098e-03,  4.40983958e-03,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  6.17650429e-03,  5.88156846e-03,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [ 2.28537575e-02,  4.34502220e-02,  3.25752162e-02,
          3.12487171e-02,  3.21161944e-02,  2.02287216e-02,
          2.70222846e-02,  2.27257480e-02,  2.15033908e-02,
          3.63352848e-02,  2.11691525e-02,  2.82951105e-02,
          4.40091628e-02,  2.72038910e-02,  3.59203235e-02,
          3.10500206e-02,  2.95899340e-02,  3.40285152e-02,
          2.15033908e-02,  2.95171533e-02,  3.14324874e-02,
          3.38212415e-02,  2.79868191e-02,  3.36647367e-02,
          2.87727138e-02,  2.15033908e-02,  1.89884319e-02,
          1.78758639e-02,  3.51451576e-02,  2.25277962e-02],
        [ 1.30602230e-03,  1.30602230e-03,  1.30602230e-03,
          1.63402945e-03,  2.23614568e-03,  2.17210687e-03,
          1.30602230e-03,  2.40772429e-03,  2.17210687e-03,
          1.32298728e-03,  2.06922237e-03,  3.50422569e-03,
          2.06798123e-03,  1.31638278e-03,  1.30602230e-03,
          1.30602230e-03,  1.30602230e-03,  1.30602230e-03,
          2.80435637e-03,  1.93369383e-03,  1.92038310e-03,
          1.30602230e-03,  1.30602230e-03,  1.81995240e-03,
          1.63402945e-03,  3.10712563e-03,  1.30602230e-03,
          1.93369383e-03,  1.32298728e-03,  2.67329187e-03],
        [ 6.97252746e-04,  3.71276181e-04,  2.08499504e-04,
          1.35845950e-04,  9.56211758e-04, -3.82434244e-05,
          1.88283146e-04,  5.69459971e-05,  5.66969550e-04,
          2.80546729e-04, -2.08829118e-04,  1.19508463e-03,
         -1.20866800e-04,  3.37281122e-04, -1.95559081e-04,
          7.26283240e-04,  4.82909706e-04,  2.38067148e-04,
         -3.53949037e-05, -1.08544914e-04, -1.45071087e-05,
          5.71099905e-04,  8.85381257e-04, -1.11832921e-04,
         -2.10383596e-05,  2.02318214e-04,  9.90601541e-04,
          2.64969391e-04,  7.02823638e-04,  9.84448736e-05],
        [ 2.97904088e-02,  2.93708126e-02,  2.98554589e-02,
          2.62674948e-02,  3.15859992e-02,  1.83291357e-02,
          1.30753487e-02,  2.86242753e-02,  3.58995883e-02,
          3.40997251e-02,  2.76146782e-02,  4.19361082e-02,
          4.31130284e-02,  2.39805478e-02,  2.43409477e-02,
          2.46815779e-02,  2.47566822e-02,  2.32625273e-02,
          3.04306535e-02,  1.35679352e-02,  3.01890674e-02,
          1.60003562e-02,  9.81562473e-03,  3.68698362e-02,
          1.99690321e-02,  9.46714993e-03,  2.37840863e-02,
          2.36476107e-02,  2.30869140e-02,  1.62320497e-02],
        [ 2.61969680e-01,  2.12119706e-01,  2.50045381e-01,
          1.95282955e-01,  2.28816868e-01,  1.92547820e-01,
          2.02378661e-01,  2.40854526e-01,  2.47925027e-01,
          1.95527676e-01,  2.34594893e-01,  2.17111933e-01,
          2.09352298e-01,  2.25211787e-01,  2.07792236e-01,
          1.99036599e-01,  2.32452206e-01,  2.51295886e-01,
          2.36514463e-01,  2.23719555e-01,  2.12368712e-01,
          2.02705879e-01,  2.33165594e-01,  2.30223451e-01,
          2.32718267e-01,  1.79626429e-01,  2.68797206e-01,
          2.51163395e-01,  1.86960019e-01,  2.35722728e-01],
        [ 8.01813383e-02,  1.08123730e-01,  8.71816256e-02,
          5.92787341e-02,  1.11109948e-01,  9.07243592e-02,
          7.01613770e-02,  8.46729782e-02,  7.83698002e-02,
          8.32093025e-02,  5.33424211e-02,  7.16751989e-02,
          8.65228147e-02,  9.28833110e-02,  8.51311038e-02,
          8.44955978e-02,  1.14681503e-01,  1.07959264e-01,
          7.23625825e-02,  9.09773526e-02,  9.08466157e-02,
          7.80806408e-02,  6.80121651e-02,  7.54131538e-02,
          1.09142694e-01,  6.85174164e-02,  7.68886967e-02,
          8.84072098e-02,  7.60919105e-02,  6.00422068e-02],
        [ 2.98397142e-01,  3.35194617e-01,  2.93230070e-01,
          3.20350483e-01,  2.58024562e-01,  2.56797286e-01,
          2.35077331e-01,  2.98095819e-01,  2.64703082e-01,
          2.86981089e-01,  2.78929546e-01,  2.77851456e-01,
          2.81555754e-01,  3.25827402e-01,  2.30395473e-01,
          2.44325225e-01,  2.28572547e-01,  3.10088517e-01,
          2.70779109e-01,  2.72893449e-01,  2.78495252e-01,
          2.61371528e-01,  2.86880144e-01,  2.71556060e-01,
          2.81902770e-01,  2.75536614e-01,  3.16439269e-01,
          2.32445869e-01,  3.05464536e-01,  2.28809821e-01],
        [-1.05142966e-04,  1.25968094e-03, -1.01491163e-03,
         -1.69672946e-03,  1.05489672e-03,  1.37681618e-03,
          8.63415094e-04, -1.34141314e-03,  1.82294741e-03,
          4.98881768e-04, -8.28459676e-04, -3.06382812e-04,
         -1.37966470e-03, -8.37147664e-04, -1.09241581e-03,
         -5.70916786e-04,  4.40684863e-03, -5.19895711e-05,
          2.43731635e-04, -4.00983810e-03, -2.39198824e-03,
         -1.48757887e-04, -3.01016199e-03, -2.07369862e-03,
          1.01884666e-03,  2.43345050e-05,  3.07375725e-04,
         -1.04024719e-03, -1.96848647e-03, -1.63122163e-03]])\}
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{154}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{r}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{importances\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{154}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([ 0.00000000e+00,  1.47399675e-03,  1.59611891e-01,  7.95406609e-03,
        7.07265924e-01,  9.88117359e-04,  0.00000000e+00,  2.88021610e-02,
        1.81395572e-03,  3.10075986e-04,  2.54548220e-02,  2.23266728e-01,
        8.34829017e-02,  2.76899061e-01, -4.20726635e-04])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{155}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} negative feature importance = model improves w/o the feature, not good.}
\PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{r}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{importances\PYZus{}mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=} \PY{n}{x\PYZus{}poly}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{155}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<AxesSubplot:>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_188_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{156}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k+kn}{import} \PY{n}{r2\PYZus{}score}
\PY{n}{r2\PYZus{}scores}\PY{o}{=} \PY{p}{[}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{157}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o+ow}{in} \PY{n}{rs}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{x\PYZus{}poly}\PY{p}{)}\PY{p}{:}
    \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{p}{,} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}
    \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}
    
    \PY{n}{dtr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
    \PY{n}{preds}\PY{o}{=} \PY{n}{dtr}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
    \PY{n}{r2\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{preds}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)} 
\PY{n}{r2\PYZus{}scores}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{157}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[0.8342499810489185,
 0.8507295074302195,
 0.8964303590847591,
 0.8982141913086568,
 0.8266630408095395,
 0.8770171803668612,
 0.8632970074328963,
 0.886570253011426,
 0.92271542477913,
 0.851450984559763,
 0.8889638934398745,
 0.8708313923778015,
 0.8427424070720972,
 0.8468819427254247,
 0.8852450623815754,
 0.9288644962118517,
 0.8762369268267965,
 0.8805775620682266,
 0.830732127669951,
 0.9064377574435227,
 0.8586500599574705,
 0.8933318638906229,
 0.8743621771964266,
 0.8598134928997424,
 0.9014078129697466,
 0.846391736792448,
 0.8671646588594207,
 0.9011810121556776,
 0.8700290234339795,
 0.859609932318675,
 0.9100160340040129,
 0.8698853363868946,
 0.869873113093306,
 0.8772202638914992,
 0.8742457696084844,
 0.9054231423808595,
 0.8773060508137518,
 0.873846529033674,
 0.8932466679072582,
 0.8609704553538775,
 0.8809018956048904,
 0.7417950686884798,
 0.8793361438399271,
 0.86144725142868,
 0.8773787854664401,
 0.8663658046109209,
 0.9056400447933785,
 0.8723918984200858,
 0.8084918195512872,
 0.8802771811113999,
 0.8744982503993644,
 0.8539004891426059,
 0.8558533050764574,
 0.8740087815465162,
 0.8802699093726982,
 0.886444666435565,
 0.8745666272782534,
 0.9022097209275634,
 0.9046474049798285,
 0.9087432967793366,
 0.8850692813359443,
 0.891351678217273,
 0.9067571433111159,
 0.8980900719598903,
 0.8434629520015686,
 0.85012927794213,
 0.8290339134383533,
 0.865808143153245,
 0.7999688895103699,
 0.8456841951032692,
 0.844523636181189,
 0.8637732282648652,
 0.8648324355142718,
 0.8688800350011098,
 0.8859436228564277,
 0.9025534657606284,
 0.905107752892047,
 0.8734830081582006,
 0.9016015564136792,
 0.8478748621626324,
 0.8665403518404913,
 0.8419872205354536,
 0.8495130694301501,
 0.8656608639841559,
 0.8682730120725083,
 0.8572239070834043,
 0.7962680618245764,
 0.8855962188221215,
 0.8840052583078057,
 0.8904098048446328,
 0.8790400145863785,
 0.8895019779938623,
 0.8777252624018409,
 0.8549649749888061,
 0.8581283572465406,
 0.8882913903574309,
 0.8691020011813109,
 0.86928255513728,
 0.8681968364242406,
 0.8739196937782319]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{158}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{sum}\PY{p}{(}\PY{n}{r2\PYZus{}scores}\PY{p}{)}\PY{o}{/}\PY{n+nb}{len}\PY{p}{(}\PY{n}{r2\PYZus{}scores}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{158}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
0.8710555495847025
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{summary}{%
\subsection{Summary:}\label{summary}}

`rol\_7 rol\_10' and `day\_of\_week rol\_10' features are significently
important.

Adding these two features into X in dtr model to check the accuracy of
dtr model forecast

    \hypertarget{add-the-features-scale-the-data-shufflesplit-to-split-the-data}{%
\subsubsection{Add the features, Scale the data, ShuffleSplit to split
the
data}\label{add-the-features-scale-the-data-shufflesplit-to-split-the-data}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{159}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} adding \PYZsq{}day\PYZus{}of\PYZus{}week rol\PYZus{}7\PYZsq{} and \PYZsq{}day\PYZus{}of\PYZus{}week rol\PYZus{}10\PYZsq{} onto X}
\PY{n}{X}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rol\PYZus{}7 rol\PYZus{}10}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=} \PY{n}{X}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rol\PYZus{}7}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{n}{X}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rol\PYZus{}10}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{X}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week rol\PYZus{}10}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=} \PY{n}{X}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{*}\PY{n}{X}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rol\PYZus{}10}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n}{X}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{159}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
            holiday  day\_of\_week        rol\_7   rol\_10  rol\_7 rol\_10  \textbackslash{}
date
2019-01-30        0            2   101.857143   132.90  1.353681e+04
2019-01-31        0            3   104.571429   118.60  1.240217e+04
2019-02-01        0            4   102.714286   102.00  1.047686e+04
2019-02-02        0            5   106.285714   101.00  1.073486e+04
2019-02-03        0            6   102.857143   100.60  1.034743e+04
{\ldots}             {\ldots}          {\ldots}          {\ldots}      {\ldots}           {\ldots}
2021-11-27        0            5  1390.571429  1316.90  1.831244e+06
2021-11-28        0            6  1390.571429  1316.00  1.829992e+06
2021-11-29        0            0  1392.500000  1374.85  1.914479e+06
2021-11-30        0            1  1394.428571  1435.20  2.001284e+06
2021-12-01        0            2  1398.571429  1436.70  2.009328e+06

            day\_of\_week rol\_10
date
2019-01-30               265.8
2019-01-31               355.8
2019-02-01               408.0
2019-02-02               505.0
2019-02-03               603.6
{\ldots}                        {\ldots}
2021-11-27              6584.5
2021-11-28              7896.0
2021-11-29                 0.0
2021-11-30              1435.2
2021-12-01              2873.4

[1037 rows x 6 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{160}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} use MinMaxScaler to scale the data }
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k+kn}{import} \PY{n}{MinMaxScaler}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{compose} \PY{k+kn}{import} \PY{n}{make\PYZus{}column\PYZus{}transformer}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{n}{transformer}\PY{o}{=} \PY{n}{make\PYZus{}column\PYZus{}transformer}\PY{p}{(}
    \PY{p}{(}\PY{n}{MinMaxScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{holiday}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,}
    \PY{p}{(}\PY{n}{MinMaxScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,}
    \PY{p}{(}\PY{n}{MinMaxScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rol\PYZus{}7}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,}
    \PY{p}{(}\PY{n}{MinMaxScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rol\PYZus{}10}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,}
    \PY{p}{(}\PY{n}{MinMaxScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rol\PYZus{}7 rol\PYZus{}10}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,}
    \PY{p}{(}\PY{n}{MinMaxScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{day\PYZus{}of\PYZus{}week rol\PYZus{}10}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}

\PY{n}{X\PYZus{}scaled}\PY{o}{=} \PY{n}{transformer}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X}\PY{p}{)}
\PY{n}{X\PYZus{}scaled}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{160}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([[0.00000000e+00, 3.33333333e-01, 0.00000000e+00, 2.11021461e-02,
        1.25480250e-03, 2.93105730e-02],
       [0.00000000e+00, 5.00000000e-01, 1.80647001e-03, 1.17597099e-02,
        8.08399078e-04, 3.92351462e-02],
       [0.00000000e+00, 6.66666667e-01, 5.70464215e-04, 9.14644105e-04,
        5.09211834e-05, 4.49913987e-02],
       {\ldots},
       [0.00000000e+00, 0.00000000e+00, 8.58976492e-01, 8.32489465e-01,
        7.49143816e-01, 0.00000000e+00],
       [0.00000000e+00, 1.66666667e-01, 8.60260037e-01, 8.71917159e-01,
        7.83295677e-01, 1.58263861e-01],
       [0.00000000e+00, 3.33333333e-01, 8.63017280e-01, 8.72897135e-01,
        7.86460310e-01, 3.16858542e-01]])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{161}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} transfer X\PYZus{}scaled into df}
\PY{n}{X\PYZus{}scaled}\PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{data}\PY{o}{=} \PY{n}{X\PYZus{}scaled}\PY{p}{,} \PY{n}{columns}\PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{162}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}scaled}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{162}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<AxesSubplot:>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_197_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{163}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} model selection: linear regression  }
\PY{c+c1}{\PYZsh{} model selection: decision tree regressor}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k+kn}{import} \PY{n}{DecisionTreeRegressor} 
\PY{n}{dtr}\PY{o}{=} \PY{n}{DecisionTreeRegressor}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{dtr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}scaled}\PY{p}{,}\PY{n}{y}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{163}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
DecisionTreeRegressor(random\_state=0)
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{setup-trainsplittest-for-crossvalidation---timeseries-and-shufflesplit}{%
\subsubsection{Setup train,split,test for CrossValidation - timeseries
and
shufflesplit}\label{setup-trainsplittest-for-crossvalidation---timeseries-and-shufflesplit}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{165}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} ShuffleSplit to split the data}
\PY{n}{report} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{split}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                                \PY{p}{]} \PY{p}{)}
\PY{n}{n}\PY{o}{=} \PY{l+m+mi}{0}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{166}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k+kn}{import} \PY{n}{ShuffleSplit}

\PY{n}{rs} \PY{o}{=} \PY{n}{ShuffleSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{168}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k+kn}{import} \PY{n}{r2\PYZus{}score}

\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k+kn}{import} \PY{n}{DecisionTreeRegressor} 
\PY{n}{dtr}\PY{o}{=} \PY{n}{DecisionTreeRegressor}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{dtr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}

\PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index} \PY{o+ow}{in} \PY{n}{rs}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{X}\PY{p}{)}\PY{p}{:}
    \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{p}{,} \PY{n}{X}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}
    \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}
        
    \PY{n}{reg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
        
    \PY{n}{dtr\PYZus{}y\PYZus{}pred} \PY{o}{=} \PY{n}{dtr}\PY{o}{.}\PY{n}{predict}\PY{p}{(} \PY{n}{X\PYZus{}test} \PY{p}{)}
  
    \PY{n}{report}\PY{o}{=} \PY{n}{report}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{split}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{n}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}error\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{max\PYZus{}error}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,} 
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mae\PYZus{}dtr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mean\PYZus{}absolute\PYZus{}error}\PY{p}{(}\PY{n}{dtr\PYZus{}y\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{,}
                            \PY{n}{ignore\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    \PY{n}{n}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}  
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
C:\textbackslash{}Users\textbackslash{}shuqi\textbackslash{}AppData\textbackslash{}Local\textbackslash{}Temp\textbackslash{}ipykernel\_10424\textbackslash{}2929842188.py:15:
FutureWarning: The frame.append method is deprecated and will be removed from
pandas in a future version. Use pandas.concat instead.
  report= report.append(\{'split': n,
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{169}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}train}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{169}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
            holiday  day\_of\_week        rol\_7   rol\_10  rol\_7 rol\_10  \textbackslash{}
date
2019-12-25        1            2   528.357143   553.00  2.921815e+05
2020-09-08        0            1   928.928571   925.55  8.597698e+05
2020-12-26        0            5   855.000000   841.80  7.197390e+05
2019-03-19        0            1   171.428571   183.00  3.137143e+04
2019-02-22        0            4   165.857143   148.70  2.466296e+04
{\ldots}             {\ldots}          {\ldots}          {\ldots}      {\ldots}           {\ldots}
2021-11-02        0            1  1104.142857  1220.60  1.347717e+06
2019-07-30        0            1   336.142857   348.90  1.172802e+05
2021-03-25        0            3   996.571429  1011.05  1.007584e+06
2021-06-20        0            6  1121.285714  1077.10  1.207737e+06
2021-06-01        0            1  1279.357143  1280.35  1.638025e+06

            day\_of\_week rol\_10
date
2019-12-25             1106.00
2020-09-08              925.55
2020-12-26             4209.00
2019-03-19              183.00
2019-02-22              594.80
{\ldots}                        {\ldots}
2021-11-02             1220.60
2019-07-30              348.90
2021-03-25             3033.15
2021-06-20             6462.60
2021-06-01             1280.35

[777 rows x 6 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{170}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{y\PYZus{}train}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{170}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
358      625.50
616     1550.25
725      775.00
77       235.50
52       107.00
         {\ldots}
1036    1110.00
210      453.00
814      880.00
901      969.00
882     2108.25
Name: y, Length: 777, dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{171}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{report}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{171}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   split max\_error\_dtr    r2\_dtr    mae\_dtr
0    0.0       1217.25  0.845386  85.513462
1    1.0       1217.25  0.933079  26.318269
2    2.0        647.25  0.965398  23.969231
3    3.0        647.25  0.982731  14.098077
4    4.0       1217.25  0.931868  26.007692
..   {\ldots}           {\ldots}       {\ldots}        {\ldots}
95  95.0       1217.25  0.940679  21.308654
96  96.0         341.0  0.984563  13.917308
97  97.0        398.25  0.985135  14.249038
98  98.0         496.0  0.976686  16.330769
99  99.0        647.25  0.955894  23.857692

[100 rows x 4 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{172}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{report}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{172}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
split             49.500000
max\_error\_dtr    749.352500
r2\_dtr             0.961679
mae\_dtr           21.064673
dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{173}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{report}\PY{o}{.}\PY{n}{var}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{173}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
split               841.666667
max\_error\_dtr    100846.757696
r2\_dtr                0.000473
mae\_dtr              60.231587
dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{174}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{preds\PYZus{}dtr}\PY{o}{=} \PY{n}{reg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
\PY{n}{preds\PYZus{}dtr}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{174}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([1202.43493928,  483.95816255,  732.98967892, 1589.53301727,
        606.55342993, 1463.63042026,  752.47814089,  778.02417384,
        453.8706306 ,  301.28370633, 1087.870777  ,  429.52743224,
        771.27018455, 1736.58659836, 1141.60170491, 1003.69147305,
        943.66343904,  503.70443652,  368.1396276 ,  700.82770499,
        284.7307046 ,  556.60009334,  436.78515487,  704.46519719,
       1115.28879074,  907.70352871, 1307.58140232,  885.7825327 ,
        902.24430768,  550.71780238,  891.18760135, 1009.56591925,
        353.02589169, 1065.84954877,  198.48747693,  498.48000746,
        505.41185401,  551.50469502,  259.29327352, 1045.30332525,
        112.48033228,  106.35496328, 1316.32680678,  759.77807981,
        624.4343209 ,  597.59800197,  278.10925342,  351.83255325,
        762.16712491,  818.50323754,  533.12522267,  618.98711467,
       1391.93145281, 1186.30173079, 1100.14149827,  398.54441726,
        940.54078585,  438.61906114,  211.99871805,  933.60439678,
       1123.70611478,  263.007711  ,  893.33842521,  247.94970592,
        806.05410911,  858.6901769 , 1058.78947764,  455.33534245,
        621.17074563,  380.21789207,  338.14380149,  800.24880817,
        271.71008376,  392.66921642, 1270.45390102,  802.62176108,
        916.02040251, 1169.37706357,  641.71359563,  260.7716338 ,
       1501.13255328, 1861.39521319,  961.91900867,  266.74136334,
       1018.23531438,  528.72095325,  331.95967125,  757.63990125,
        818.49430173, 1417.19232404, 1126.16601923,  662.93102319,
       1413.89598737, 1031.8033063 ,  520.65616857, 1108.07990406,
       1071.20433112,  579.8316236 , 1154.86503778,  550.37152887,
        390.92845715, 1320.50958931,  900.55824674, 1021.25538574,
        299.995429  ,  289.91268344,  927.79792214,  489.62301135,
        125.99463493,  886.98482844,  544.35219539,  687.64164307,
       1063.36290475,  943.35018375, 1164.17242839,  315.92950753,
        123.72362261,  975.18057209, 1222.90390686,  891.53396908,
       1161.1489576 ,  753.29341909,  405.57918371, 1350.18864184,
        357.86052087,  157.0481479 ,  850.86850133,  402.61015915,
       1140.15933785,  131.70402785, 1440.02499554,  254.79032542,
       1160.74660171,  678.91990743,  723.23892091, 1296.37400061,
       1548.68795303, 1389.72548451,  955.26384805,  512.78790438,
        829.79827535,  254.92812865,  473.89754472,  897.0961391 ,
        323.3516452 , 1156.30097518,  799.28842736, 1296.99998878,
        140.37785004,  504.34619302,  860.29698825,  912.61478598,
       1083.3621038 ,  872.22442626,  165.30493057,  723.17621652,
        904.95682019,  658.54288366,  293.86685692, 1147.16123488,
        347.46502737,  939.71571327, 1029.16737912,  845.56400179,
        303.90460894,  808.68271702,  576.42751158,  346.01935082,
       1100.53819829, 1269.36312988,  408.81719388,  174.39760242,
        757.24207576,  764.95680721,  695.54589553,  918.40885258,
       1224.25312877, 1541.64219553,  810.09888941,  300.30862148,
        842.60158922,  585.51112204, 1313.613167  ,  360.94523227,
       1183.06224363,  468.74705857, 1081.76393074,  702.74039571,
        730.512082  ,  629.54111973, 1035.48945683,  893.25468204,
       1238.13873127,  958.94040125,  609.86877626, 1008.93601856,
        773.63315857,  776.15112063,  277.24128899,  268.79157432,
       1209.08908681, 1158.71531394,  811.14076627,  186.55026405,
        225.15217889, 1460.07705514,  681.03642779,  212.8856848 ,
       1672.98552643,  300.94639507,  690.36786064,  834.05156575,
       1004.73678668, 1156.87278602,  537.78602137,  184.77776138,
        685.34465355,  258.12542078,  826.74579635, 1088.65570951,
        284.0045511 ,  805.54183965,  448.12598443, 1093.26012639,
        629.48593769, 1010.4092002 , 1188.82927307,  493.18918527,
        382.32435631, 1251.10911902,  386.29089745, 1273.89234184,
       1754.79639151,  379.45370932, 1125.49484041, 1692.14462006,
       1045.16841465,  896.04223949,  321.30020396, 1062.20931979,
        502.08943269,  499.45808907,  737.48472284,  586.39169945,
        172.7986359 ,  716.02477158,  757.54203573, 1626.02401601,
        798.24100047,  381.44541926, 1610.10181004,  426.85761265,
       1673.51142506, 1002.61654795,  471.90291981,  867.6786881 ,
        507.42258542,  565.52169695,  154.33669802,  837.81375559])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{175}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{dtr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{175}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
DecisionTreeRegressor(random\_state=0)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{176}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{176}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
777
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{177}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{comp\PYZus{}dtr}\PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n}{X}\PY{o}{.}\PY{n}{index}\PY{p}{)}
\PY{n}{comp\PYZus{}dtr}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{177}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Empty DataFrame
Columns: []
Index: [2019-01-30 00:00:00, 2019-01-31 00:00:00, 2019-02-01 00:00:00,
2019-02-02 00:00:00, 2019-02-03 00:00:00, 2019-02-04 00:00:00, 2019-02-05
00:00:00, 2019-02-06 00:00:00, 2019-02-07 00:00:00, 2019-02-08 00:00:00,
2019-02-09 00:00:00, 2019-02-10 00:00:00, 2019-02-11 00:00:00, 2019-02-12
00:00:00, 2019-02-13 00:00:00, 2019-02-14 00:00:00, 2019-02-15 00:00:00,
2019-02-16 00:00:00, 2019-02-17 00:00:00, 2019-02-18 00:00:00, 2019-02-19
00:00:00, 2019-02-20 00:00:00, 2019-02-21 00:00:00, 2019-02-22 00:00:00,
2019-02-23 00:00:00, 2019-02-24 00:00:00, 2019-02-25 00:00:00, 2019-02-26
00:00:00, 2019-02-27 00:00:00, 2019-02-28 00:00:00, 2019-03-01 00:00:00,
2019-03-02 00:00:00, 2019-03-03 00:00:00, 2019-03-04 00:00:00, 2019-03-05
00:00:00, 2019-03-06 00:00:00, 2019-03-07 00:00:00, 2019-03-08 00:00:00,
2019-03-09 00:00:00, 2019-03-10 00:00:00, 2019-03-11 00:00:00, 2019-03-12
00:00:00, 2019-03-13 00:00:00, 2019-03-14 00:00:00, 2019-03-15 00:00:00,
2019-03-16 00:00:00, 2019-03-17 00:00:00, 2019-03-18 00:00:00, 2019-03-19
00:00:00, 2019-03-20 00:00:00, 2019-03-21 00:00:00, 2019-03-22 00:00:00,
2019-03-23 00:00:00, 2019-03-24 00:00:00, 2019-03-25 00:00:00, 2019-03-26
00:00:00, 2019-03-27 00:00:00, 2019-03-28 00:00:00, 2019-03-29 00:00:00,
2019-03-30 00:00:00, 2019-03-31 00:00:00, 2019-04-01 00:00:00, 2019-04-02
00:00:00, 2019-04-03 00:00:00, 2019-04-04 00:00:00, 2019-04-05 00:00:00,
2019-04-06 00:00:00, 2019-04-07 00:00:00, 2019-04-08 00:00:00, 2019-04-09
00:00:00, 2019-04-10 00:00:00, 2019-04-11 00:00:00, 2019-04-12 00:00:00,
2019-04-13 00:00:00, 2019-04-14 00:00:00, 2019-04-15 00:00:00, 2019-04-16
00:00:00, 2019-04-17 00:00:00, 2019-04-18 00:00:00, 2019-04-19 00:00:00,
2019-04-20 00:00:00, 2019-04-21 00:00:00, 2019-04-22 00:00:00, 2019-04-23
00:00:00, 2019-04-24 00:00:00, 2019-04-25 00:00:00, 2019-04-26 00:00:00,
2019-04-27 00:00:00, 2019-04-28 00:00:00, 2019-04-29 00:00:00, 2019-04-30
00:00:00, 2019-05-01 00:00:00, 2019-05-02 00:00:00, 2019-05-03 00:00:00,
2019-05-04 00:00:00, 2019-05-05 00:00:00, 2019-05-06 00:00:00, 2019-05-07
00:00:00, 2019-05-08 00:00:00, 2019-05-09 00:00:00, {\ldots}]

[1037 rows x 0 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{178}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{comp\PYZus{}dtr}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y\PYZus{}true}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=} \PY{n}{y}\PY{o}{.}\PY{n}{values}
\PY{n}{comp\PYZus{}dtr}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y\PYZus{}true}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{178}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
date
2019-01-30     117.0
2019-01-31     109.0
2019-02-01      86.0
2019-02-02     102.0
2019-02-03      86.0
               {\ldots}
2021-11-27    1141.0
2021-11-28    1141.0
2021-11-29    1738.5
2021-11-30    1738.5
2021-12-01    1156.0
Name: y\_true, Length: 1037, dtype: float64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{179}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} fill the prediction blank positions with nan, concat with \PYZsq{}preds\PYZsq{} values  }
\PY{n}{pred\PYZus{}dtr}\PY{o}{=} \PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{]}\PY{o}{*} \PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{preds\PYZus{}dtr}\PY{p}{)}
\PY{n}{pred\PYZus{}dtr}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{179}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 nan,
 1202.4349392779502,
 483.9581625510459,
 732.9896789154229,
 1589.533017268759,
 606.5534299342636,
 1463.630420263906,
 752.4781408854441,
 778.0241738410876,
 453.8706305995628,
 301.2837063315354,
 1087.8707770010485,
 429.527432239859,
 771.270184547671,
 1736.5865983623844,
 1141.6017049140737,
 1003.6914730453582,
 943.663439038108,
 503.70443652023744,
 368.1396275957401,
 700.8277049863457,
 284.7307046046428,
 556.6000933439268,
 436.7851548748635,
 704.4651971855113,
 1115.2887907409904,
 907.7035287118808,
 1307.5814023223554,
 885.782532703027,
 902.2443076816725,
 550.7178023825694,
 891.1876013470279,
 1009.5659192530127,
 353.0258916854593,
 1065.849548773366,
 198.487476929059,
 498.48000746077196,
 505.4118540051152,
 551.5046950225992,
 259.293273523623,
 1045.303325245884,
 112.4803322794331,
 106.35496328276585,
 1316.326806775121,
 759.778079814054,
 624.4343209036191,
 597.5980019686072,
 278.1092534166251,
 351.83255325040005,
 762.167124914231,
 818.5032375351088,
 533.1252226682836,
 618.987114666258,
 1391.9314528066639,
 1186.301730785505,
 1100.1414982717015,
 398.5444172593007,
 940.5407858520358,
 438.61906113537185,
 211.99871804848522,
 933.6043967841086,
 1123.7061147819818,
 263.0077109958337,
 893.3384252097202,
 247.9497059154965,
 806.0541091109899,
 858.690176897375,
 1058.7894776436617,
 455.3353424493896,
 621.1707456251739,
 380.21789207302584,
 338.14380148678885,
 800.2488081742708,
 271.7100837605953,
 392.66921641617034,
 1270.4539010213077,
 802.6217610832628,
 916.0204025135332,
 1169.37706357429,
 641.7135956346032,
 260.77163379930334,
 1501.1325532804162,
 1861.395213193899,
 961.9190086666509,
 266.74136334081965,
 1018.2353143823941,
 528.7209532497856,
 331.9596712455051,
 757.6399012533077,
 818.494301725672,
 1417.1923240396707,
 1126.166019229544,
 662.9310231862701,
 1413.895987365769,
 1031.8033062985967,
 520.6561685674166,
 1108.0799040587826,
 1071.2043311156542,
 579.8316235996084,
 1154.8650377810604,
 550.3715288659267,
 390.9284571524513,
 1320.5095893101998,
 900.5582467409215,
 1021.255385742096,
 299.9954289979233,
 289.912683439911,
 927.7979221394036,
 489.62301134508994,
 125.99463493350822,
 886.9848284355268,
 544.3521953922384,
 687.6416430745022,
 1063.362904751721,
 943.3501837524361,
 1164.1724283861274,
 315.92950753023274,
 123.72362260988439,
 975.1805720885857,
 1222.9039068596314,
 891.5339690825109,
 1161.1489575995565,
 753.293419085042,
 405.57918370778145,
 1350.1886418422594,
 357.86052086742825,
 157.0481478950541,
 850.8685013281174,
 402.61015914802357,
 1140.1593378524008,
 131.70402785261905,
 1440.0249955421302,
 254.79032541777138,
 1160.7466017089598,
 678.9199074305305,
 723.238920912564,
 1296.3740006114806,
 1548.6879530285007,
 1389.7254845092932,
 955.263848048729,
 512.7879043790597,
 829.7982753456165,
 254.92812864870166,
 473.89754471740264,
 897.0961390974172,
 323.35164520409705,
 1156.3009751845184,
 799.2884273615035,
 1296.999988780986,
 140.3778500408215,
 504.3461930171361,
 860.2969882500809,
 912.614785976075,
 1083.3621038024462,
 872.2244262613983,
 165.30493057007214,
 723.1762165200473,
 904.9568201880653,
 658.5428836562259,
 293.8668569210631,
 1147.1612348773717,
 347.46502737037605,
 939.7157132741931,
 1029.1673791183284,
 845.5640017921806,
 303.9046089423533,
 808.6827170173349,
 576.4275115783964,
 346.0193508154657,
 1100.538198294874,
 1269.3631298794232,
 408.81719387500715,
 174.39760242215368,
 757.242075762749,
 764.9568072132477,
 695.5458955272289,
 918.4088525761784,
 1224.2531287657066,
 1541.6421955294836,
 810.0988894056943,
 300.308621482193,
 842.6015892164231,
 585.5111220377845,
 1313.613166997239,
 360.94523227236476,
 1183.062243626001,
 468.74705857097456,
 1081.763930742655,
 702.7403957130396,
 730.5120819999213,
 629.541119730385,
 1035.4894568295222,
 893.2546820366774,
 1238.1387312730444,
 958.9404012462396,
 609.8687762566201,
 1008.9360185601697,
 773.6331585684595,
 776.1511206252648,
 277.24128899054574,
 268.79157432047805,
 1209.0890868109404,
 1158.7153139394375,
 811.140766274073,
 186.55026405293071,
 225.15217889033045,
 1460.0770551367757,
 681.0364277861655,
 212.885684803019,
 1672.9855264258329,
 300.9463950726909,
 690.3678606419315,
 834.0515657482291,
 1004.7367866810646,
 1156.872786016983,
 537.7860213727993,
 184.77776138193425,
 685.3446535541103,
 258.1254207816899,
 826.7457963485641,
 1088.6557095077694,
 284.004551095036,
 805.5418396468142,
 448.12598443181616,
 {\ldots}]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{180}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} add preds into the df}
\PY{n}{comp\PYZus{}dtr}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{preds}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pred\PYZus{}dtr}
\PY{n}{comp\PYZus{}dtr}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{180}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
            y\_true       preds
date
2019-01-30   117.0         NaN
2019-01-31   109.0         NaN
2019-02-01    86.0         NaN
2019-02-02   102.0         NaN
2019-02-03    86.0         NaN
{\ldots}            {\ldots}         {\ldots}
2021-11-27  1141.0  867.678688
2021-11-28  1141.0  507.422585
2021-11-29  1738.5  565.521697
2021-11-30  1738.5  154.336698
2021-12-01  1156.0  837.813756

[1037 rows x 2 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{181}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{comp\PYZus{}dtr}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{181}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<AxesSubplot:xlabel='date'>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_215_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
